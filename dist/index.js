"use strict";var Po=Object.create;var Ye=Object.defineProperty;var Co=Object.getOwnPropertyDescriptor;var wo=Object.getOwnPropertyNames;var Eo=Object.getPrototypeOf,Ro=Object.prototype.hasOwnProperty;var gn=(t,e)=>()=>(t&&(e=t(t=0)),e);var Lo=(t,e)=>{for(var n in e)Ye(t,n,{get:e[n],enumerable:!0})},pn=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of wo(e))!Ro.call(t,o)&&o!==n&&Ye(t,o,{get:()=>e[o],enumerable:!(r=Co(e,o))||r.enumerable});return t};var Mo=(t,e,n)=>(n=t!=null?Po(Eo(t)):{},pn(e||!t||!t.__esModule?Ye(n,"default",{value:t,enumerable:!0}):n,t)),ko=t=>pn(Ye({},"__esModule",{value:!0}),t);function _o(){return`signal_${++Do}_${Date.now()}`}function Ze(t){if(W.some(e=>e.name===t.name))throw new Error(`Plugin "${t.name}" is already registered`);if(W.push(t),t.onRegister)try{t.onRegister()}catch(e){console.error(`Error in plugin "${t.name}" onRegister:`,e)}`${t.name}`}function _e(t){let e=typeof t=="string"?t:t.name,n=W.findIndex(o=>o.name===e);if(n===-1)return!1;let r=W[n];if(r.onUnregister)try{r.onUnregister()}catch(o){console.error(`Error in plugin "${r.name}" onUnregister:`,o)}return W.splice(n,1),`${r.name}`,!0}function fn(){return[...W]}function mn(){let t=W.map(e=>e.name);W.forEach(e=>{if(e.onUnregister)try{e.onUnregister()}catch(n){console.error(`Error in plugin "${e.name}" onUnregister:`,n)}}),W.length=0,`${t.length}`}function yn(){xe=!0}function hn(){xe=!1}function bn(){return xe}function vn(t,e,n){let r={id:_o(),type:t,createdAt:Date.now(),label:n};if(Qe.set(r.id,r),xe){for(let o of W)if(o.onSignalCreate)try{o.onSignalCreate(r,e)}catch(s){console.error(`Error in plugin "${o.name}" onSignalCreate:`,s)}}return r}function Sn(t,e,n,r="set"){if(!xe)return;let o=Qe.get(t);if(!o)return;let s={signal:o,oldValue:e,newValue:n,timestamp:Date.now(),source:r};for(let i of W)if(i.onSignalUpdate)try{i.onSignalUpdate(s)}catch(l){console.error(`Error in plugin "${i.name}" onSignalUpdate:`,l)}}function Tn(t){if(!xe)return;let e=Qe.get(t);if(e){for(let n of W)if(n.onSignalDestroy)try{n.onSignalDestroy(e)}catch(r){console.error(`Error in plugin "${n.name}" onSignalDestroy:`,r)}Qe.delete(t)}}function xn(t={}){let{verbose:e=!1,logCreates:n=!0,logUpdates:r=!0,logDestroys:o=!0}=t;return{name:"logger",version:"1.0.0",onRegister(){},onSignalCreate(s,i){n&&`${s.type}${s.label||s.id}`},onSignalUpdate(s){r&&(`${s.signal.type}${s.signal.label||s.signal.id}`,e||`${s.oldValue}${s.newValue}`)},onSignalDestroy(s){o&&`${s.type}${s.label||s.id}`},onUnregister(){}}}function Pn(t={}){let{maxHistory:e=50}=t,n=[],r=[];return{plugin:{name:"time-travel",version:"1.0.0",onRegister(){},onSignalUpdate(s){n.push({signalId:s.signal.id,oldValue:s.oldValue,newValue:s.newValue,timestamp:s.timestamp}),r.length=0,n.length>e&&n.shift()},onUnregister(){n.length=0,r.length=0}},undo(){if(n.length===0)return!1;let s=n.pop();return r.push(s),`${s.newValue}${s.oldValue}`,!0},redo(){if(r.length===0)return!1;let s=r.pop();return n.push(s),`${s.oldValue}${s.newValue}`,!0},getHistory(){return[...n]},clear(){n.length=0,r.length=0},get historySize(){return n.length},get futureSize(){return r.length}}}function Cn(){let t={totalUpdates:0,updatesBySignal:new Map,averageUpdateTime:0,slowestUpdate:null},e=0,n=new Map;return{plugin:{name:"performance",version:"1.0.0",onRegister(){},onBeforeUpdate(o){return n.set(o.signal.id,performance.now()),o.newValue},onSignalUpdate(o){let s=n.get(o.signal.id);if(s!==void 0){let i=performance.now()-s;e+=i,n.delete(o.signal.id),t.totalUpdates++,t.updatesBySignal.set(o.signal.id,(t.updatesBySignal.get(o.signal.id)||0)+1),t.averageUpdateTime=e/t.totalUpdates,(!t.slowestUpdate||i>t.slowestUpdate.duration)&&(t.slowestUpdate={signalId:o.signal.label||o.signal.id,duration:i})}},onUnregister(){}},getMetrics(){return{...t,updatesBySignal:new Map(t.updatesBySignal)}},reset(){t.totalUpdates=0,t.updatesBySignal.clear(),t.averageUpdateTime=0,t.slowestUpdate=null,e=0},printMetrics(){"=".repeat(50),`${t.totalUpdates}`,`${t.averageUpdateTime.toFixed(3)}`,t.slowestUpdate&&`${t.slowestUpdate.signalId}${t.slowestUpdate.duration.toFixed(3)}`,t.updatesBySignal.forEach((o,s)=>{`${s}${o}`}),"=".repeat(50)+""}}}function wn(t){return{name:"validation",version:"1.0.0",onRegister(){},onBeforeUpdate(e){let n=e.signal.label;if(n&&t[n]&&!t[n](e.newValue)){console.error(`[Validation] \u274C Invalid value for signal "${n}":`,e.newValue);return}return e.newValue},onUnregister(){}}}var W,Qe,Do,xe,et=gn(()=>{"use strict";W=[],Qe=new Map,Do=0,xe=!0});async function jo(){return new Promise(t=>{Vt?gr.push(()=>t()):(Vt=!0,t())})}function qo(){let t=gr.shift();t?t():Vt=!1}async function $e(t){await jo();try{return await t()}finally{qo()}}function Wo(t,e){let n=()=>k.get(t);return{name:e.name,version:e.version,onRegister(){if(e.onRegister)try{e.onRegister()}catch(r){console.error(`[PluginManager] Error in "${t}" onRegister:`,r);let o=n();o&&o.metadata.errorCount++}},onUnregister(){if(e.onUnregister)try{e.onUnregister()}catch(r){console.error(`[PluginManager] Error in "${t}" onUnregister:`,r);let o=n();o&&o.metadata.errorCount++}},onSignalCreate(r,o){let s=n();if(s?.enabled&&e.onSignalCreate)try{e.onSignalCreate(r,o)}catch(i){console.error(`[PluginManager] Error in "${t}" onSignalCreate:`,i),s.metadata.errorCount++}},onBeforeUpdate(r){let o=n();if(!o?.enabled)return r.newValue;if(e.onBeforeUpdate)try{return e.onBeforeUpdate(r)}catch(s){return console.error(`[PluginManager] Error in "${t}" onBeforeUpdate:`,s),o.metadata.errorCount++,r.newValue}return r.newValue},onSignalUpdate(r){let o=n();if(o?.enabled&&e.onSignalUpdate)try{e.onSignalUpdate(r)}catch(s){console.error(`[PluginManager] Error in "${t}" onSignalUpdate:`,s),o.metadata.errorCount++}},onSignalDestroy(r){let o=n();if(o?.enabled&&e.onSignalDestroy)try{e.onSignalDestroy(r)}catch(s){console.error(`[PluginManager] Error in "${t}" onSignalDestroy:`,s),o.metadata.errorCount++}}}}async function pr(t,e,n={}){await $e(()=>{if(k.has(t))throw new Error(`[PluginManager] Plugin "${t}" is already registered`);let r=n.enabled!==!1,o=Date.now(),s={plugin:e,enabled:r,registeredAt:o,enabledAt:r?o:null,disabledAt:r?null:o,metadata:{enableCount:r?1:0,disableCount:r?0:1,errorCount:0}};k.set(t,s);let i=Wo(t,e);Ze(i),`${t}`})}async function fr(t){return $e(()=>{let e=k.get(t);return e?e.enabled?(`${t}`,!1):(e.enabled=!0,e.enabledAt=Date.now(),e.metadata.enableCount++,`${t}`,!0):(`${t}`,!1)})}async function mr(t){return $e(()=>{let e=k.get(t);return e?e.enabled?(e.enabled=!1,e.disabledAt=Date.now(),e.metadata.disableCount++,`${t}`,!0):(`${t}`,!1):(`${t}`,!1)})}async function yr(t){return $e(()=>{let e=k.get(t);return e?(_e(e.plugin.name),k.delete(t),`${t}`,!0):(`${t}`,!1)})}function hr(t){return k.get(t)?.plugin}function br(t){return k.get(t)?.enabled??!1}function vr(){return Array.from(k.entries()).map(([t,e])=>({name:t,plugin:e.plugin,enabled:e.enabled,registeredAt:e.registeredAt,enabledAt:e.enabledAt,disabledAt:e.disabledAt,metadata:{...e.metadata}}))}function zt(){let t=0,e=0,n=0;for(let r of k.values())r.enabled?t++:e++,n+=r.metadata.errorCount;return{total:k.size,enabled:t,disabled:e,totalErrors:n}}async function Sr(){await $e(()=>{let t=Array.from(k.keys());for(let e of t){let n=k.get(e);n&&_e(n.plugin.name)}k.clear(),`${t.length}`})}function Tr(){"=".repeat(60);let t=zt();if(`${t.total}`,`${t.enabled}`,`${t.disabled}`,`${t.totalErrors}`,k.size>0)for(let[e,n]of k.entries()){let r=n.enabled?"\u2705 Enabled":"\u23F8\uFE0F  Disabled",o=n.plugin.version?` v${n.plugin.version}`:"",s=n.metadata.errorCount>0?` (${n.metadata.errorCount} errors)`:"";`${r}${e}${o}${s}`}"=".repeat(60)+""}var k,Vt,gr,gt,pt,xr=gn(()=>{"use strict";et();k=new Map,Vt=!1,gr=[];gt=class{constructor(e={}){this.verbose=e.verbose??!1,this.logCreates=e.logCreates??!0,this.logUpdates=e.logUpdates??!0,this.logDestroys=e.logDestroys??!0,this.startTime=Date.now()}getElapsedTime(){return`+${Date.now()-this.startTime}ms`}formatTimestamp(e){return new Date(e).toISOString()}getPlugin(){return{name:"logger",version:"2.0.0",onRegister:()=>{`${this.formatTimestamp(Date.now())}`,this.startTime=Date.now()},onSignalCreate:(e,n)=>{if(!this.logCreates)return;let r=e.label||e.id;`${this.getElapsedTime()}${e.type}${r}`,this.verbose?this.formatTimestamp(e.createdAt):`${JSON.stringify(n)}`},onSignalUpdate:e=>{if(!this.logUpdates)return;let n=e.signal.label||e.signal.id,r=e.source?`[${e.source}]`:"";`${this.getElapsedTime()}${e.signal.type}${n}${r}`,this.verbose?this.formatTimestamp(e.timestamp):`${JSON.stringify(e.oldValue)}${JSON.stringify(e.newValue)}`},onSignalDestroy:e=>{if(!this.logDestroys)return;let n=e.label||e.id;`${this.getElapsedTime()}${e.type}${n}`},onUnregister:()=>{`${this.getElapsedTime()}`}}}},pt=class{constructor(e={}){this.history=[];this.future=[];this.snapshots=new Map;this.maxHistory=e.maxHistory??50}getPlugin(){return{name:"time-travel",version:"2.0.0",onRegister:()=>{`${this.maxHistory}`},onSignalUpdate:e=>{this.history.push({...e}),this.future=[],this.history.length>this.maxHistory&&this.history.shift()},onUnregister:()=>{`${this.history.length}`,this.clear()}}}undo(){if(this.history.length===0)return!1;let e=this.history.pop();return this.future.push(e),`${e.signal.label||e.signal.id}${JSON.stringify(e.newValue)}${JSON.stringify(e.oldValue)}`,!0}redo(){if(this.future.length===0)return!1;let e=this.future.pop();return this.history.push(e),`${e.signal.label||e.signal.id}${JSON.stringify(e.oldValue)}${JSON.stringify(e.newValue)}`,!0}getHistory(){return this.history.map(e=>({...e}))}getHistoryForSignal(e){return this.history.filter(n=>n.signal.id===e).map(n=>({...n}))}createSnapshot(e){this.snapshots.set(e,[...this.history]),`${e}${this.history.length}`}restoreSnapshot(e){let n=this.snapshots.get(e);return n?(this.history=[...n],this.future=[],`${e}`,!0):(`${e}`,!1)}listSnapshots(){return Array.from(this.snapshots.keys())}clear(){this.history=[],this.future=[]}getStats(){return{historySize:this.history.length,futureSize:this.future.length,snapshotCount:this.snapshots.size,maxHistory:this.maxHistory}}printHistory(e=10){"=".repeat(60);let n=this.getStats();`${n.historySize}${n.maxHistory}`,`${n.futureSize}`,`${n.snapshotCount}`,this.history.length>0&&(`${Math.min(e,this.history.length)}`,this.history.slice(-e).forEach((o,s)=>{let i=o.signal.label||o.signal.id,l=new Date(o.timestamp).toISOString();s+1,`${l}${i}${JSON.stringify(o.oldValue)}${JSON.stringify(o.newValue)}`})),"=".repeat(60)+""}}});var ws={};Lo(ws,{LogViewer:()=>To,LoggerPlugin:()=>gt,LoggerPluginEnhanced:()=>de,PerformanceTab:()=>to,SignalGraphVisualizer:()=>Zr,TimeTravelPlugin:()=>pt,TimeTravelPluginEnhanced:()=>Je,TimeTravelTimeline:()=>mo,__DEVTOOLS__:()=>Ve,arePluginsEnabled:()=>bn,batch:()=>rt,benchmarkBatchedUpdates:()=>Tt,benchmarkMemoryUsage:()=>Ct,benchmarkSignalUpdates:()=>St,calculateMemoryUsage:()=>Rt,clearAllPlugins:()=>Sr,clearPerformanceMetrics:()=>qr,clearPlugins:()=>mn,clearResults:()=>Zt,combine:()=>Er,compareWithRedux:()=>xt,compareWithZustand:()=>Pt,configureProfiler:()=>Hn,createArraySignal:()=>Ar,createComputed:()=>X,createConsoleOverlay:()=>Wr,createDebugLogger:()=>bo,createEffect:()=>ne,createEnhancedTimeTravelPlugin:()=>fo,createFilteredLogger:()=>vo,createLogger:()=>yo,createLoggerPlugin:()=>xn,createMinimalLogger:()=>ho,createPerformancePlugin:()=>Cn,createPersistentSignal:()=>qt,createRecordSignal:()=>Ir,createResource:()=>kr,createSignal:()=>_,createStorageAdapter:()=>jt,createTimeTravelPlugin:()=>Pn,createValidationPlugin:()=>wn,customBenchmark:()=>tn,debounce:()=>Dr,derive:()=>wr,detectEnvironment:()=>Fe,disableDevTools:()=>$r,disablePlugin:()=>mr,disablePlugins:()=>hn,disableProfiler:()=>it,enableDevTools:()=>Ur,enablePlugin:()=>fr,enablePlugins:()=>yn,enableProfiler:()=>st,endBatch:()=>ir,endBatchMeasurement:()=>dt,endLatencyMeasurement:()=>jn,exportResults:()=>en,exportSnapshot:()=>Kr,filter:()=>Lr,flushBatches:()=>lr,flushSync:()=>Nn,formatMemorySize:()=>Lt,getAllPlugins:()=>vr,getBatchDepth:()=>cr,getBatchRecords:()=>Jn,getBatchStats:()=>Wn,getBridgeConfig:()=>ao,getDependencies:()=>Hr,getDependencyGraph:()=>oe,getLatencySamples:()=>Kn,getPendingCount:()=>dr,getPerformanceMetrics:()=>be,getPerformanceSummary:()=>ze,getPlugin:()=>hr,getPluginStats:()=>zt,getProfilerData:()=>pe,getRegisteredPlugins:()=>fn,getResults:()=>Qt,getSignal:()=>wt,getSignalLatencyStats:()=>qn,getSignalsByType:()=>jr,getStorageAdapter:()=>bt,getSubscribers:()=>Gr,initializeDevToolsBridge:()=>oo,isBatching:()=>ur,isBridgeConnected:()=>io,isDevToolsEnabled:()=>A,isPluginEnabled:()=>br,isProfilerEnabled:()=>ae,listSignals:()=>re,logResults:()=>Yt,map:()=>Rr,memo:()=>Mr,monitor:()=>Br,notifyPerformanceMetric:()=>po,notifySignalCreated:()=>uo,notifySignalUpdated:()=>go,persist:()=>vt,printDependencyGraph:()=>Jr,printPluginStatus:()=>Tr,queueBatchCallback:()=>ar,recordBatchOperation:()=>ct,registerManagedPlugin:()=>pr,registerPlugin:()=>Ze,registerSignal:()=>Fr,resetProfiler:()=>at,resetStorageAdapter:()=>Gt,runBenchmarkSuite:()=>Xt,safeParse:()=>Ne,safeStringify:()=>Oe,shutdownDevToolsBridge:()=>so,startBatch:()=>sr,startBatchMeasurement:()=>lt,startLatencyMeasurement:()=>Gn,throttle:()=>_r,trackDependency:()=>Vr,trackUpdate:()=>Nr,unregisterManagedPlugin:()=>yr,unregisterPlugin:()=>_e,unregisterSignal:()=>Or,untrack:()=>On,untrackDependency:()=>zr,useSignal:()=>Pr,useSignalEffect:()=>Cr,useSignalValue:()=>Ht});module.exports=ko(ws);et();var ue=1,kt=2,Mt=4,Dt=8,En=16,Rn=1e4,Ln=new Array(Rn),nt=0;function Ao(t){nt<Rn&&(t.value=void 0,t.subscribers=null,t.listeners=null,t.dependencies=null,t.computeFn=null,t.flags=0,Ln[nt++]=t)}var tt=new WeakMap,_t=new Map;function Mn(t){return _t.get(t)}var Bt=1e4,kn=new Array(Bt),Pe=0,Ae=0,At=!1;function Io(t){if(t.flags&kt)return;let e=(Ae+1)%Bt;e===Pe&&(console.error("[SignalForge] Batch queue overflow \u2192 forcing flush"),It()),t.flags|=kt,kn[Ae]=t,Ae=e,At||(At=!0,queueMicrotask(It))}function It(){for(At=!1;Pe!==Ae;){let t=kn[Pe];Pe=(Pe+1)%Bt,t.flags&=~kt,t.flags&ue&&Ie(t)}}var Dn=new Array(100),_n=0,j=null;function Bo(t){Dn[_n++]=j,j=t}function Uo(){j=Dn[--_n]}var $o=function(){return this._node.value},Fo=function(t){this._node.subscribers||(this._node.subscribers=new Set),this._node.subscribers.add(t)},Oo=function(t){this._node.subscribers&&this._node.subscribers.delete(t)};function Ut(t,e=null){let n=nt>0?Ln[--nt]:{value:void 0,subscribers:null,listeners:null,dependencies:null,computeFn:null,flags:0};return n.value=t,n.computeFn=e,n.flags=e?En|ue:0,e&&Ie(n),n}function An(t,e){return j?(j!==t&&(In(t,j),zo(j,e)),t.flags&ue&&t.computeFn&&Ie(t),t.value):(t.flags&ue&&t.computeFn&&Ie(t),t.value)}function No(t,e,n){if(t.flags&En)throw new Error("Cannot set computed signal");if(typeof n=="function"&&(n=n(t.value)),Object.is(n,t.value))return;let r=t.value;t.value=n;let o=tt.get(e);o&&Sn(o,r,n,"set"),Un(t)}function In(t,e){t.subscribers||(t.subscribers=new Set),t.subscribers.add(e)}function Vo(t,e){t.subscribers&&t.subscribers.delete(e)}function zo(t,e){t.dependencies||(t.dependencies=new Set),t.dependencies.has(e)||(t.dependencies.add(e),In(e._node,t))}function Bn(t){if(t.dependencies){for(let e of t.dependencies)Vo(e._node,t);t.dependencies.clear()}}function $t(t){if(!(t.flags&ue)&&(t.flags|=ue,Io(t),t.subscribers))for(let e of t.subscribers)$t(e)}function Ie(t){if(t.computeFn&&!(t.flags&Mt)){t.flags|=Mt,Bn(t),Bo(t);try{let e=t.computeFn();t.flags&=~ue,t.flags&=~Mt,Object.is(e,t.value)||(t.value=e,Un(t))}finally{Uo()}}}function Un(t){if(t.subscribers)for(let e of t.subscribers)$t(e);if(t.flags&Dt&&t.listeners)for(let e of t.listeners)e(t.value)}function $n(t,e){return t.listeners||(t.listeners=new Set),t.listeners.add(e),t.flags|=Dt,()=>{t.listeners.delete(e),t.listeners.size===0&&(t.flags&=~Dt)}}function Ft(t){Bn(t),t.subscribers&&t.subscribers.clear(),t.listeners&&t.listeners.clear(),Ao(t)}function _(t){let e=Ut(t,null),n={get:()=>An(e,n),set:o=>No(e,n,o),subscribe:o=>$n(e,o),destroy:()=>{let o=tt.get(n);o&&(Tn(o),_t.delete(o),tt.delete(n)),Ft(e)},_node:e,_peek:$o,_addSubscriber:Fo,_removeSubscriber:Oo},r=vn("signal",t);return tt.set(n,r.id),_t.set(r.id,n),n}function X(t){let e,n=j;j=null;try{e=t()}finally{j=n}let r=Ut(e,t),o={get:()=>An(r,o),set:()=>{throw new Error("Cannot set computed signal")},subscribe:s=>$n(r,s),destroy:()=>Ft(r),_node:r,_peek:()=>r.value,_addSubscriber:s=>{r.subscribers||(r.subscribers=new Set),r.subscribers.add(s)},_removeSubscriber:s=>{r.subscribers&&r.subscribers.delete(s)},_markDirty:()=>$t(r),_recompute:()=>Ie(r)};return o}function ne(t){let e=Ut(void 0,t);return()=>Ft(e)}function rt(t){let e=t();return Fn(),e}function Fn(){Pe!==Ae&&It()}function On(t){let e=j;j=null;try{return t()}finally{j=e}}var Nn=Fn;var K=!1,Be=null,zn=0,ge=new Map,ie=[],ot=new Map,Ue=new Map,te={maxSamplesPerSignal:100,maxBatchRecords:50,autoComputeStats:!1,emitEvents:!0};function st(t){K||(te={...te,...t},K=!0,Be=performance.now())}function it(){K&&(K=!1)}function ae(){return K}function at(){ge.clear(),ie.length=0,ot.clear(),Ue.clear(),Be=K?performance.now():null,zn=0}function Hn(t){te={...te,...t}}function Gn(t,e){K&&ot.set(t,{startTime:performance.now(),subscriberCount:e})}function jn(t,e,n){if(!K)return;let r=ot.get(t);if(!r)return;let o=performance.now(),s=o-r.startTime,i={signalId:t,type:e,startTime:r.startTime,endTime:o,latency:s,subscriberCount:r.subscriberCount,skipped:n},l=ge.get(t);l||(l=[],ge.set(t,l)),l.push(i),l.length>te.maxSamplesPerSignal&&l.shift(),ot.delete(t),te.emitEvents}function lt(t){if(!K)return-1;let e=++zn;return Ue.set(e,{startTime:performance.now(),operationCount:0,affectedSignals:new Set,depth:t}),e}function ct(t,e){if(!K||t===-1)return;let n=Ue.get(t);n&&(n.operationCount++,n.affectedSignals.add(e))}function dt(t){if(!K||t===-1)return;let e=Ue.get(t);if(!e)return;let n=performance.now(),r=n-e.startTime,o={batchId:t,startTime:e.startTime,endTime:n,duration:r,operationCount:e.operationCount,affectedSignals:Array.from(e.affectedSignals),depth:e.depth};ie.push(o),ie.length>te.maxBatchRecords&&ie.shift(),Ue.delete(t),te.emitEvents}function pe(){let t=performance.now(),e=Be?t-Be:0,n=new Map,r=0;for(let[s,i]of ge.entries()){if(i.length===0)continue;let l=Xn(s,i);n.set(s,l),r+=i.length}let o=Yn(ie);return{enabled:K,startedAt:Be,duration:e,signalStats:n,batchRecords:[...ie],batchStats:o,totalSamples:r,totalSignals:ge.size}}function qn(t){let e=ge.get(t);return!e||e.length===0?null:Xn(t,e)}function Wn(){return Yn(ie)}function Kn(t){return ge.get(t)||[]}function Jn(){return[...ie]}function Xn(t,e){if(e.length===0)return{signalId:t,type:"signal",sampleCount:0,min:0,max:0,mean:0,median:0,p95:0,p99:0,stdDev:0,avgSubscribers:0,skippedCount:0};let n=e[0].type,r=e.map(C=>C.latency),o=[...r].sort((C,E)=>C-E),s=o[0],i=o[o.length-1],c=r.reduce((C,E)=>C+E,0)/r.length,d=Math.floor(o.length/2),h=o.length%2===0?(o[d-1]+o[d])/2:o[d],S=Vn(o,.95),x=Vn(o,.99),M=r.map(C=>Math.pow(C-c,2)).reduce((C,E)=>C+E,0)/r.length,w=Math.sqrt(M),$=e.reduce((C,E)=>C+E.subscriberCount,0)/e.length,ee=e.filter(C=>C.skipped).length;return{signalId:t,type:n,sampleCount:e.length,min:s,max:i,mean:c,median:h,p95:S,p99:x,stdDev:w,avgSubscribers:$,skippedCount:ee}}function Yn(t){if(t.length===0)return{totalBatches:0,avgDuration:0,minDuration:0,maxDuration:0,avgOperationsPerBatch:0,totalOperations:0};let e=t.map(d=>d.duration),n=t.map(d=>d.operationCount),r=t.length,o=e.reduce((d,h)=>d+h,0)/r,s=Math.min(...e),i=Math.max(...e),l=n.reduce((d,h)=>d+h,0),c=l/r;return{totalBatches:r,avgDuration:o,minDuration:s,maxDuration:i,avgOperationsPerBatch:c,totalOperations:l}}function Vn(t,e){if(t.length===0)return 0;let n=e*(t.length-1),r=Math.floor(n),o=Math.ceil(n),s=n-r;return r===o?t[r]:t[r]*(1-s)+t[o]*s}var Ho="[SignalForge]",Ot={BATCH_MISMATCH:"endBatch called without matching startBatch",MAX_BATCH_DEPTH:"Maximum batch depth (1000) exceeded",MAX_DEPENDENCY_DEPTH:"Maximum dependency depth (100) exceeded - possible circular dependency",INVALID_SIGNAL:"Invalid signal provided",PLUGIN_NOT_FOUND:"Plugin not found",PLUGIN_ALREADY_REGISTERED:"Plugin with this name is already registered",STORAGE_NOT_AVAILABLE:"Storage backend not available",DEVTOOLS_CONNECTION_FAILED:"Failed to connect to DevTools"};var Qn="3.0.0";function Zn(t,e,n){return Math.min(Math.max(t,e),n)}function er(t){return t===void 0?100:Zn(t,10,1e4)}function tr(t){return t===void 0?1e3:Zn(t,100,1e4)}function nr(t,e=100){return t.length<=e?t:t.substring(0,e-3)+"..."}function Nt(t){return`${Ho} ${t}`}var q=0,Ce=-1,fe=new Set,ut=!1;function or(){ut||(ut=!0,typeof queueMicrotask<"u"?queueMicrotask(rr):Promise.resolve().then(rr))}function rr(){if(ut=!1,q>0)return;let t=Array.from(fe);fe.clear();for(let e of t)try{e()}catch(n){console.error("Error in batch callback:",n)}}function sr(){if(q>=1e3)throw new Error(Nt(Ot.MAX_BATCH_DEPTH));q++,q===1&&ae()&&(Ce=lt(q))}function ir(){if(q<=0)throw new Error(Nt(Ot.BATCH_MISMATCH));q--,q===0&&ae()&&Ce!==-1&&(dt(Ce),Ce=-1),q===0&&fe.size>0&&or()}function ar(t,e){fe.add(t),q>0&&ae()&&Ce!==-1&&e&&ct(Ce,e),q===0&&or()}function lr(){ut=!1;let t=Array.from(fe);fe.clear();for(let e of t)try{e()}catch(n){console.error("Error in batch callback:",n)}}function cr(){return q}function dr(){return fe.size}function ur(){return q>0}et();xr();var me=require("react");function Ko(){if(typeof me.useState!="function"||typeof me.useEffect!="function")throw new Error(`[SignalForge] React hooks unavailable. Possible duplicate React instance or invalid bundler resolution.
Troubleshooting:
  1. Ensure only one react copy: node_modules/react (no nested copy under library).
  2. Clear Metro cache: npx react-native start --reset-cache.
  3. Verify metro.config.js extraNodeModules maps react to example app node_modules.`)}Ko();function Ht(t){let[e,n]=(0,me.useState)(()=>t.get());return(0,me.useEffect)(()=>(n(t.get()),t.subscribe(()=>n(t.get()))),[t]),e}function Pr(t){let[e]=(0,me.useState)(()=>{let r=typeof t=="function"?t():t;return _(r)});return[Ht(e),e.set.bind(e)]}var we=require("react");var ft=new WeakMap;function Cr(t,e=[]){let n=(0,we.useRef)({}),r=(0,we.useRef)(null),o=(0,we.useRef)(null);(0,we.useEffect)(()=>{let s=()=>{if(!ft.get(n.current)){ft.set(n.current,!0);try{r.current&&(r.current(),r.current=null);let i=t();typeof i=="function"&&(r.current=i)}finally{ft.set(n.current,!1)}}};return o.current=ne(s),()=>{r.current&&r.current(),o.current&&o.current(),ft.delete(n.current)}},e)}function Fe(){if(typeof window>"u")return"node";if(typeof global<"u"){let t=global;if(t.HermesInternal||t.__fbBatchedBridgeConfig||t.nativeModuleProxy)return"react-native"}return typeof navigator<"u"&&navigator.product==="ReactNative"?"react-native":typeof window<"u"&&typeof document<"u"&&typeof window.localStorage<"u"?"web":"node"}function Oe(t,e=!1){let n=new WeakSet;try{return JSON.stringify(t,(r,o)=>{if(o===void 0)return"__undefined__";if(o===null)return null;if(typeof o=="function")return e&&`${r}`,"__function__";if(o instanceof Date)return{__type__:"Date",value:o.toISOString()};if(o instanceof RegExp)return{__type__:"RegExp",value:o.toString()};if(typeof o=="object"&&o!==null){if(n.has(o))return e&&`${r}`,"__circular__";n.add(o)}return o})}catch(r){e&&console.error("[StorageAdapter] Serialization error:",r);try{return JSON.stringify(t)}catch{return"{}"}}}function Ne(t,e=!1){try{return JSON.parse(t,(n,r)=>{if(r!=="__undefined__"&&r!=="__function__"){if(r==="__circular__")return null;if(r&&typeof r=="object"){if(r.__type__==="Date")return new Date(r.value);if(r.__type__==="RegExp"){let o=r.value.match(/^\/(.+)\/([gimuy]*)$/);if(o)return new RegExp(o[1],o[2])}}return r}})}catch(n){return e&&console.error("[StorageAdapter] Deserialization error:",n),null}}var mt=class{constructor(e={}){this.prefix=e.prefix||"signalforge_",this.devMode=e.devMode??Wt,this.serialize=e.serialize||(n=>Oe(n,this.devMode)),this.deserialize=e.deserialize||(n=>Ne(n,this.devMode))}getKey(e){return`${this.prefix}${e}`}async load(e){try{let n=localStorage.getItem(this.getKey(e));return n===null?null:this.deserialize(n)}catch(n){return this.devMode&&console.error(`[StorageAdapter] Failed to load "${e}":`,n),null}}async save(e,n){try{let r=this.serialize(n);localStorage.setItem(this.getKey(e),r)}catch(r){throw this.devMode&&console.error(`[StorageAdapter] Failed to save "${e}":`,r),r}}async clear(e){try{localStorage.removeItem(this.getKey(e))}catch(n){throw this.devMode&&console.error(`[StorageAdapter] Failed to clear "${e}":`,n),n}}isAvailable(){try{let e="__storage_test__";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch{return!1}}async getAllKeys(){try{let e=[];for(let n=0;n<localStorage.length;n++){let r=localStorage.key(n);r&&r.startsWith(this.prefix)&&e.push(r.slice(this.prefix.length))}return e}catch(e){return this.devMode&&console.error("[StorageAdapter] Failed to get all keys:",e),[]}}async clearAll(){try{let e=await this.getAllKeys();for(let n of e)await this.clear(n)}catch(e){throw this.devMode&&console.error("[StorageAdapter] Failed to clear all:",e),e}}},yt=class{constructor(e={}){this.prefix=e.prefix||"signalforge_",this.devMode=e.devMode??Wt,this.serialize=e.serialize||(n=>Oe(n,this.devMode)),this.deserialize=e.deserialize||(n=>Ne(n,this.devMode));try{this.AsyncStorage=require("@react-native-async-storage/async-storage").default}catch{try{this.AsyncStorage=require("react-native").AsyncStorage}catch{this.devMode&&console.error("[StorageAdapter] AsyncStorage not found. Install @react-native-async-storage/async-storage"),this.AsyncStorage=null}}}getKey(e){return`${this.prefix}${e}`}async load(e){if(!this.AsyncStorage)return this.devMode,null;try{let n=await this.AsyncStorage.getItem(this.getKey(e));return n===null?null:this.deserialize(n)}catch(n){return this.devMode&&console.error(`[StorageAdapter] Failed to load "${e}":`,n),null}}async save(e,n){if(!this.AsyncStorage){this.devMode;return}try{let r=this.serialize(n);await this.AsyncStorage.setItem(this.getKey(e),r)}catch(r){throw this.devMode&&console.error(`[StorageAdapter] Failed to save "${e}":`,r),r}}async clear(e){if(!this.AsyncStorage){this.devMode;return}try{await this.AsyncStorage.removeItem(this.getKey(e))}catch(n){throw this.devMode&&console.error(`[StorageAdapter] Failed to clear "${e}":`,n),n}}isAvailable(){return this.AsyncStorage!==null}async getAllKeys(){if(!this.AsyncStorage)return[];try{return(await this.AsyncStorage.getAllKeys()).filter(n=>n.startsWith(this.prefix)).map(n=>n.slice(this.prefix.length))}catch(e){return this.devMode&&console.error("[StorageAdapter] Failed to get all keys:",e),[]}}async clearAll(){if(this.AsyncStorage)try{let n=(await this.getAllKeys()).map(r=>this.getKey(r));await this.AsyncStorage.multiRemove(n)}catch(e){throw this.devMode&&console.error("[StorageAdapter] Failed to clear all:",e),e}}},ht=class{constructor(e={}){this.storage=new Map;this.prefix=e.prefix||"signalforge_",this.devMode=e.devMode??Wt,this.devMode}getKey(e){return`${this.prefix}${e}`}async load(e){let n=this.storage.get(this.getKey(e));return n!==void 0?n:null}async save(e,n){let r=JSON.parse(JSON.stringify(n));this.storage.set(this.getKey(e),r)}async clear(e){this.storage.delete(this.getKey(e))}isAvailable(){return!0}async getAllKeys(){let e=[];for(let n of this.storage.keys())n.startsWith(this.prefix)&&e.push(n.slice(this.prefix.length));return e}async clearAll(){let e=await this.getAllKeys();for(let n of e)this.storage.delete(this.getKey(n))}},ye=null;function bt(t={}){if(ye)return ye;switch(Fe()){case"web":ye=new mt(t);break;case"react-native":ye=new yt(t);break;case"node":case"unknown":default:ye=new ht(t);break}return ye}function Gt(){ye=null}function jt(t=Fe(),e={}){switch(t){case"web":return new mt(e);case"react-native":return new yt(e);case"node":case"unknown":default:return new ht(e)}}function vt(t,e={}){let n=e.adapter||bt(),r=e.key||`signal_${Math.random().toString(36).slice(2)}`,o=e.serialize||(c=>c),s=e.deserialize||(c=>c);n.load(r).then(c=>{if(c!==null)try{let d=s(c);t.set(d)}catch(d){e.onError&&e.onError(d)}}).catch(c=>{e.onError&&e.onError(c)});let i,l=ne(()=>{let c=t.get(),d=()=>{try{let h=o(c);n.save(r,h).catch(S=>{e.onError&&e.onError(S)})}catch(h){e.onError&&e.onError(h)}};e.debounce?(i!==void 0&&clearTimeout(i),i=setTimeout(d,e.debounce)):d()});return()=>{l(),i!==void 0&&clearTimeout(i)}}function qt(t,e,n={}){let r=_(e);return vt(r,{...n,key:t}),r}var Wt=typeof globalThis.__DEV__<"u"?globalThis.__DEV__:process.env.NODE_ENV!=="production";var L=[];function J(){return typeof performance<"u"&&performance.now?performance.now():Date.now()}function St(t){console.time("SignalForge: Sequential Updates");let e=J(),n=_(0),r=X(()=>n.get()*2),o=0;for(let h=0;h<t;h++)n.set(h),o=r.get();let s=J();console.timeEnd("SignalForge: Sequential Updates");let i=s-e,l=i/t,c=t/i*1e3,d={name:"SignalForge Sequential Updates",iterations:t,totalTime:i,averageTime:l,opsPerSecond:c,metadata:{lastValue:o}};return L.push(d),d}function Tt(t){console.time("SignalForge: Batched Updates");let e=J(),n=Array.from({length:t},()=>_(0)),r=X(()=>n.reduce((h,S)=>h+S.get(),0));rt(()=>{for(let h=0;h<t;h++)n[h].set(h)});let o=r.get(),s=J();console.timeEnd("SignalForge: Batched Updates");let i=s-e,l=i/t,c=t/i*1e3,d={name:"SignalForge Batched Updates",iterations:t,totalTime:i,averageTime:l,opsPerSecond:c,metadata:{computedValue:o}};return L.push(d),d}var Kt=class{constructor(e){this.listeners=new Set;this.state=e}getState(){return this.state}dispatch(e){e.type==="INCREMENT"?this.state={count:this.state.count+1}:e.type==="SET"&&(this.state={count:e.payload}),this.listeners.forEach(n=>n())}subscribe(e){return this.listeners.add(e),()=>this.listeners.delete(e)}};function xt(t=1e4){console.time("Redux-like: Sequential Updates");let e=J(),n=new Kt({count:0}),r=0;n.subscribe(()=>{r=n.getState().count*2});for(let d=0;d<t;d++)n.dispatch({type:"SET",payload:d});let o=J();console.timeEnd("Redux-like: Sequential Updates");let s=o-e,i=s/t,l=t/s*1e3,c={name:"Redux-like Sequential Updates",iterations:t,totalTime:s,averageTime:i,opsPerSecond:l,metadata:{lastValue:r}};return L.push(c),c}var Jt=class{constructor(e){this.listeners=new Set;this.state=e}getState(){return this.state}setState(e){this.state={...this.state,...e},this.listeners.forEach(n=>n())}subscribe(e){return this.listeners.add(e),()=>this.listeners.delete(e)}};function Pt(t=1e4){console.time("Zustand-like: Sequential Updates");let e=J(),n=new Jt({count:0}),r=0;n.subscribe(()=>{r=n.getState().count*2});for(let d=0;d<t;d++)n.setState({count:d});let o=J();console.timeEnd("Zustand-like: Sequential Updates");let s=o-e,i=s/t,l=t/s*1e3,c={name:"Zustand-like Sequential Updates",iterations:t,totalTime:s,averageTime:i,opsPerSecond:l,metadata:{lastValue:r}};return L.push(c),c}function Ct(t){let e=typeof performance<"u"&&performance.memory,n=e?performance.memory.usedJSHeapSize:0,r=J(),o=Array.from({length:t},(S,x)=>_(x));typeof global<"u"&&global.gc&&global.gc();let s=J(),i=e?performance.memory.usedJSHeapSize:0,l=s-r,c=i-n,d=c/t,h={name:"Memory Usage",iterations:t,totalTime:l,averageTime:l/t,opsPerSecond:t/l*1e3,metadata:{memoryUsedBytes:c,memoryUsedKB:c/1024,memoryUsedMB:c/(1024*1024),bytesPerSignal:d,hasMemoryAPI:e,signalCount:o.length}};return L.push(h),h}function Xt(t=1e4){return L.length=0,St(t),Tt(Math.floor(t/10)),xt(t),Pt(t),Ct(1e3),L}function Yt(){if(L.length===0)return;"=".repeat(100),""+"Benchmark Name".padEnd(35)+"Iterations".padEnd(12)+"Total (ms)".padEnd(12)+"Avg (ms)".padEnd(12)+"Ops/sec".padEnd(15),"=".repeat(100);for(let s of L)""+s.name.padEnd(35)+s.iterations.toLocaleString().padEnd(12)+s.totalTime.toFixed(2).padEnd(12)+s.averageTime.toFixed(4).padEnd(12)+s.opsPerSecond.toLocaleString(void 0,{maximumFractionDigits:0}).padEnd(15);"=".repeat(100);let t=L.find(s=>s.name==="SignalForge Sequential Updates"),e=L.find(s=>s.name==="Redux-like Sequential Updates"),n=L.find(s=>s.name==="Zustand-like Sequential Updates");if(t&&e){let s=e.totalTime/t.totalTime;`${s.toFixed(2)}`,s>1}if(t&&n){let s=n.totalTime/t.totalTime;`${s.toFixed(2)}`,s>1}let r=L.find(s=>s.name==="SignalForge Batched Updates");t&&r&&`${(t.averageTime/r.averageTime).toFixed(2)}`;let o=L.find(s=>s.name==="Memory Usage");o&&o.metadata?.hasMemoryAPI&&(`${o.metadata.memoryUsedKB.toFixed(2)}${o.iterations}`,`${o.metadata.bytesPerSignal.toFixed(0)}`)}function Qt(){return[...L]}function Zt(){L.length=0}function en(){return JSON.stringify(L,null,2)}function tn(t,e,n=1e3){console.time(t);let r=J();for(let d=0;d<n;d++)e();let o=J();console.timeEnd(t);let s=o-r,i=s/n,l=n/s*1e3,c={name:t,iterations:n,totalTime:s,averageTime:i,opsPerSecond:l};return L.push(c),c}function wr(t,e){return X(()=>{let n=t.map(r=>r.get());return e(...n)})}function Er(t){return X(()=>t.map(e=>e.get()))}function Rr(t,e){return X(()=>e(t.get()))}function Lr(t,e,n){return X(()=>{let r=t.get();return e(r)?r:n})}function Mr(t,e=Object.is){let n=t._peek?t._peek():t.get();return X(()=>{let r=t.get();return e(r,n)||(n=r),n})}function kr(t){let e=_({status:"pending",data:void 0,error:void 0});return t().then(n=>{e.set({status:"success",data:n,error:void 0})}).catch(n=>{e.set({status:"error",data:void 0,error:n})}),e}function Dr(t,e){let n=_(t._peek?t._peek():t.get()),r;return ne(()=>{let o=t.get();r!==void 0&&clearTimeout(r),r=setTimeout(()=>{n.set(o)},e)}),n}function _r(t,e){let n=_(t._peek?t._peek():t.get()),r=0,o,s;return ne(()=>{let i=t.get(),l=Date.now(),c=l-r;c>=e?(n.set(i),r=l,o=void 0):(o=i,s===void 0&&(s=setTimeout(()=>{o!==void 0&&(n.set(o),r=Date.now(),o=void 0),s=void 0},e-c)))}),n}function Ar(t=[]){let e=_(t);return{...e,push(...n){e.set(r=>[...r,...n])},pop(){let n;return e.set(r=>{let o=[...r];return n=o.pop(),o}),n},filter(n){e.set(r=>r.filter(n))},map(n){return e.get().map(n)},find(n){return e.get().find(n)},remove(n){e.set(r=>r.filter(o=>o!==n))},clear(){e.set([])},get length(){return e.get().length}}}function Ir(t={}){let e=_(t);return{...e,setKey(n,r){e.set(o=>({...o,[n]:r}))},deleteKey(n){e.set(r=>{let o={...r};return delete o[n],o})},hasKey(n){return n in e.get()},getKey(n){return e.get()[n]},keys(){return Object.keys(e.get())},values(){return Object.values(e.get())},entries(){return Object.entries(e.get())},clear(){e.set({})}}}function Br(t,e){let n=0,r=0,o=0,s=0;return{get(){let i=performance.now(),l=t.get(),c=performance.now()-i;return n++,o+=c,n%100===0&&`${e}${n}${(o/n).toFixed(3)}`,l},set(i){let l=performance.now();t.set(i);let c=performance.now()-l;r++,s+=c,`${e}${r}${c.toFixed(3)}`},subscribe:t.subscribe.bind(t),destroy:t.destroy.bind(t),_node:t._node,_addSubscriber:t._addSubscriber?t._addSubscriber.bind(t):void 0,_removeSubscriber:t._removeSubscriber?t._removeSubscriber.bind(t):void 0,_peek:t._peek?t._peek.bind(t):void 0}}var Ve=!1,F={enabled:!1,trackPerformance:!0,logToConsole:!1,maxPerformanceSamples:1e3,flipperEnabled:!1},O=new Map,ce=new WeakMap,he=[],Jo=0,le=null;function Ur(t={}){Ve=!0,Object.assign(F,t),F.enabled=!0,F.logToConsole,F.flipperEnabled&&Xo()}function $r(){Ve=!1,F.enabled=!1,le&&Yo()}function A(){return Ve&&F.enabled}function Fr(t,e,n){if(!A())return"";let r=`${e}_${++Jo}`,o;if(typeof Error<"u")try{throw new Error}catch(i){o=i.stack?.split(`
`).slice(2,6).join(`
`)}let s={id:r,type:e,value:Ee(n),subscriberCount:0,dependencies:[],subscribers:[],createdAt:Date.now(),updatedAt:Date.now(),updateCount:0,creationStack:o};return O.set(r,s),ce.set(t,r),F.logToConsole&&`${e}${r}`,nn("signalRegistered",s),r}function Or(t){if(!A())return;let e=ce.get(t);e&&(O.delete(e),ce.delete(t),F.logToConsole&&`${e}`,nn("signalUnregistered",{id:e}))}function Nr(t,e,n){if(!A()){e();return}let r=ce.get(t);if(!r){e();return}let o=O.get(r);if(!o){e();return}let s=performance.now(),i=!1,l;try{e(),l=t._peek?t._peek():t.get(),i=Object.is(n,l)}catch(c){throw console.error(`[SignalForge] Error updating signal "${r}"`,c),c}finally{let d=performance.now()-s;if(o.value=Ee(l),o.updatedAt=Date.now(),i||o.updateCount++,F.trackPerformance){let h={signalId:r,type:o.type,timestamp:s,duration:d,skipped:i,previousValue:Ee(n),newValue:Ee(l)};Qo(h),F.logToConsole&&d>16&&`${r}${d.toFixed(2)}`}nn("signalUpdated",{id:r,value:o.value,duration:d,skipped:i})}}function Vr(t,e){if(!A())return;let n=ce.get(t),r=ce.get(e);if(!n||!r)return;let o=O.get(n),s=O.get(r);!o||!s||(o.dependencies.includes(r)||o.dependencies.push(r),s.subscribers.includes(n)||s.subscribers.push(n),s.subscriberCount=s.subscribers.length)}function zr(t,e){if(!A())return;let n=ce.get(t),r=ce.get(e);if(!n||!r)return;let o=O.get(n),s=O.get(r);!o||!s||(o.dependencies=o.dependencies.filter(i=>i!==r),s.subscribers=s.subscribers.filter(i=>i!==n),s.subscriberCount=s.subscribers.length)}function re(){return A()?Array.from(O.values()).sort((t,e)=>t.createdAt-e.createdAt):[]}function wt(t){if(A())return O.get(t)}function Hr(t){return A()?O.get(t)?.dependencies||[]:[]}function Gr(t){return A()?O.get(t)?.subscribers||[]:[]}function oe(){if(!A())return[];let t=[],e=new Map,n=(r,o=0)=>{let s=e.get(r);if(s!==void 0)return Math.max(s,o);e.set(r,o);let i=O.get(r);if(i)for(let l of i.subscribers)n(l,o+1);return o};for(let[r,o]of O)o.dependencies.length===0&&n(r,0);for(let[r,o]of O)t.push({id:r,type:o.type,dependencies:o.dependencies,subscribers:o.subscribers,depth:e.get(r)||0});return t.sort((r,o)=>r.depth-o.depth)}function jr(t){return A()?Array.from(O.values()).filter(e=>e.type===t):[]}function be(t){if(!A())return[];let e=[...he];return t?e.slice(-t):e}function ze(){if(!A())return{totalUpdates:0,totalDuration:0,averageDuration:0,slowestUpdate:null,updatesByType:{}};let t=0,e=null,n={signal:0,computed:0,effect:0};for(let s of he)s.skipped||(t+=s.duration,n[s.type]++,(!e||s.duration>e.duration)&&(e=s));let r=he.filter(s=>!s.skipped).length,o=r>0?t/r:0;return{totalUpdates:r,totalDuration:t,averageDuration:o,slowestUpdate:e,updatesByType:n}}function qr(){he.length=0}function Xo(){try{typeof global<"u"&&global.__FLIPPER__&&(le=global.__FLIPPER__.addPlugin({getId:()=>"signalforge-inspector",onConnect:e=>{e.send("initialState",{signals:re(),graph:oe(),config:F}),e.receive("getSignals",()=>{e.send("signals",re())}),e.receive("getGraph",()=>{e.send("graph",oe())}),e.receive("getPerformance",()=>{e.send("performance",{metrics:be(100),summary:ze()})})},onDisconnect:()=>{le=null}}))}catch(t){}}function Yo(){if(le){try{le.disconnect()}catch(t){}le=null}}function nn(t,e){if(le&&F.flipperEnabled)try{le.send(t,e)}catch{}}function Wr(){if(typeof window>"u"||typeof document>"u")return{show:()=>{},hide:()=>{},destroy:()=>{}};let t=document.createElement("div");t.id="signalforge-devtools-overlay",t.style.cssText=`
    position: fixed;
    top: 0;
    right: 0;
    width: 400px;
    height: 100vh;
    background: rgba(0, 0, 0, 0.95);
    color: #fff;
    font-family: monospace;
    font-size: 12px;
    padding: 16px;
    overflow-y: auto;
    z-index: 999999;
    display: none;
    box-shadow: -2px 0 10px rgba(0, 0, 0, 0.5);
  `,document.body.appendChild(t);let e=()=>{let r=re(),o=ze();t.innerHTML=`
      <h2 style="margin: 0 0 16px 0; color: #61dafb;">SignalForge DevTools</h2>
      
      <div style="margin-bottom: 16px;">
        <h3 style="margin: 0 0 8px 0;">Performance</h3>
        <div>Total Updates: ${o.totalUpdates}</div>
        <div>Avg Duration: ${o.averageDuration.toFixed(2)}ms</div>
        <div>Total Time: ${o.totalDuration.toFixed(2)}ms</div>
      </div>
      
      <div style="margin-bottom: 16px;">
        <h3 style="margin: 0 0 8px 0;">Signals (${r.length})</h3>
        ${r.map(s=>`
          <div style="margin-bottom: 8px; padding: 8px; background: rgba(255,255,255,0.1); border-radius: 4px;">
            <div style="color: #61dafb;">${s.id}</div>
            <div style="color: #999; font-size: 10px;">${s.type}</div>
            <div>Value: ${JSON.stringify(s.value)}</div>
            <div style="font-size: 10px; color: #999;">
              Deps: ${s.dependencies.length} | Subs: ${s.subscriberCount} | Updates: ${s.updateCount}
            </div>
          </div>
        `).join("")}
      </div>
      
      <button
        onclick="document.getElementById('signalforge-devtools-overlay').style.display='none'"
        style="padding: 8px 16px; background: #61dafb; color: #000; border: none; border-radius: 4px; cursor: pointer;"
      >
        Close
      </button>
    `},n;return{show:()=>{t.style.display="block",e(),n=setInterval(e,1e3)},hide:()=>{t.style.display="none",n&&clearInterval(n)},destroy:()=>{n&&clearInterval(n),t.remove()}}}function Ee(t){try{if(t===null||typeof t>"u"||typeof t=="boolean"||typeof t=="number"||typeof t=="string")return t;if(typeof t=="function")return`[Function: ${t.name||"anonymous"}]`;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.slice(0,10).map(Ee);if(typeof t=="object"){let e=Object.keys(t).slice(0,10),n={};for(let r of e)n[r]=Ee(t[r]);return n}return String(t)}catch{return"[Unserializable]"}}function Qo(t){he.push(t),he.length>F.maxPerformanceSamples&&he.shift()}function Kr(){return{timestamp:Date.now(),config:{...F},signals:re(),graph:oe(),performance:{metrics:be(),summary:ze()}}}function Jr(){if(!A())return;let t=oe();console.group("SignalForge Dependency Graph");for(let e of t){let n="  ".repeat(e.depth),r=e.dependencies.length>0?` \u2190 [${e.dependencies.join(", ")}]`:"",o=e.subscribers.length>0?` \u2192 [${e.subscribers.join(", ")}]`:"";`${n}${e.id}${e.type}${r}${o}`}console.groupEnd()}var I=require("react");var rn=class{constructor(){this.listeners=new Map;this.sequence=0}on(e,n){let r=e;return this.listeners.has(r)||this.listeners.set(r,new Set),this.listeners.get(r).add(n),()=>this.off(e,n)}off(e,n){let r=e,o=this.listeners.get(r);o&&(o.delete(n),o.size===0&&this.listeners.delete(r))}emit(e,n){let r={type:e,payload:n,timestamp:Date.now(),sequence:++this.sequence},o=this.listeners.get(e);if(o)for(let i of o)try{i(r)}catch(l){console.error(`[DevTools] Error in listener for ${e}:`,l)}let s=this.listeners.get("*");if(s)for(let i of s)try{i(r)}catch(l){console.error("[DevTools] Error in wildcard listener:",l)}}removeAllListeners(){this.listeners.clear(),this.sequence=0}getListenerCount(e){if(e)return this.listeners.get(e)?.size||0;let n=0;for(let r of this.listeners.values())n+=r.size;return n}},Xr=typeof process<"u"?process.env.NODE_ENV!=="production":!0,He={enabled:!1,trackPerformance:!0,logToConsole:!1,maxPerformanceSamples:1e3,slowUpdateThreshold:16,emitPerformanceWarnings:!0},Zo=new Map;var es=new rn;function Yr(t={}){Xr=!0,Object.assign(He,t),He.enabled=!0,He.logToConsole}function ve(){return Xr&&He.enabled}function Qr(){return ve()?Array.from(Zo.values()).sort((t,e)=>t.createdAt-e.createdAt):[]}function Re(t,e){return es.on(t,e)}var y=require("react/jsx-runtime"),on=class{constructor(e,n){this.repulsionForce=3e3;this.attractionForce=.01;this.centerForce=.01;this.damping=.9;this.minDistance=50;this.nodes=new Map,this.edges=[],this.width=e,this.height=n}setGraph(e,n){this.nodes=e,this.edges=n}tick(){for(let e of this.nodes.values())e.fx=0,e.fy=0;this.applyRepulsion(),this.applyAttraction(),this.applyCenterForce(),this.updatePositions()}applyRepulsion(){let e=Array.from(this.nodes.values());for(let n=0;n<e.length;n++)for(let r=n+1;r<e.length;r++){let o=e[n],s=e[r],i=s.x-o.x,l=s.y-o.y,c=i*i+l*l,d=Math.sqrt(c)||1;if(d<this.minDistance){let h=this.repulsionForce/(this.minDistance*this.minDistance),S=i/d*h,x=l/d*h;o.fx-=S,o.fy-=x,s.fx+=S,s.fy+=x}else{let h=this.repulsionForce/c,S=i/d*h,x=l/d*h;o.fx-=S,o.fy-=x,s.fx+=S,s.fy+=x}}}applyAttraction(){for(let e of this.edges){let n=this.nodes.get(e.source),r=this.nodes.get(e.target);if(!n||!r)continue;let o=r.x-n.x,s=r.y-n.y,i=Math.sqrt(o*o+s*s)||1,l=i*this.attractionForce,c=o/i*l,d=s/i*l;n.fx+=c,n.fy+=d,r.fx-=c,r.fy-=d}}applyCenterForce(){let e=this.width/2,n=this.height/2;for(let r of this.nodes.values()){let o=e-r.x,s=n-r.y;r.fx+=o*this.centerForce,r.fy+=s*this.centerForce}}updatePositions(){for(let e of this.nodes.values()){e.vx=(e.vx+e.fx)*this.damping,e.vy=(e.vy+e.fy)*this.damping,e.x+=e.vx,e.y+=e.vy;let n=50;e.x<n?(e.x=n,e.vx*=-.5):e.x>this.width-n&&(e.x=this.width-n,e.vx*=-.5),e.y<n?(e.y=n,e.vy*=-.5):e.y>this.height-n&&(e.y=this.height-n,e.vy*=-.5)}}initializePositions(){let e=this.width/2,n=this.height/2,r=Math.min(this.width,this.height)/4;for(let o of this.nodes.values())if(o.x===0&&o.y===0){let s=Math.random()*Math.PI*2,i=Math.random()*r;o.x=e+Math.cos(s)*i,o.y=n+Math.sin(s)*i,o.vx=0,o.vy=0}}},Zr=({width:t=800,height:e=600,showLabels:n=!0,animate:r=!0,updateInterval:o=50,enablePhysics:s=!0,nodeRadius:i=20,highlightDuration:l=1e3})=>{let[c,d]=(0,I.useState)({nodes:new Map,edges:[]}),[h,S]=(0,I.useState)(null),x=(0,I.useRef)(new on(t,e)),U=(0,I.useRef)(null),M=(0,I.useRef)(Date.now()),w=(0,I.useCallback)(()=>{if(!ve())return{nodes:new Map,edges:[]};let u=Qr(),v=new Map,b=[];for(let f of u){let T=c.nodes.get(f.id);v.set(f.id,{id:f.id,type:f.type,value:f.value,label:f.name||f.id.split("_")[0],x:T?.x||0,y:T?.y||0,vx:T?.vx||0,vy:T?.vy||0,fx:0,fy:0,isUpdating:T?.isUpdating||!1,lastUpdate:f.updatedAt,subscriberCount:f.subscriberCount,dependencies:f.dependencies,subscribers:f.subscribers})}for(let f of v.values())for(let T of f.dependencies)v.has(T)&&b.push({source:f.id,target:T});return{nodes:v,edges:b}},[c.nodes]),$=(0,I.useCallback)(u=>{d(v=>{let b=w();return x.current.setGraph(b.nodes,b.edges),x.current.initializePositions(),b})},[w]),ee=(0,I.useCallback)(u=>{let{id:v}=u.payload;d(b=>{let f=b.nodes.get(v);return f&&(f.isUpdating=!0,f.lastUpdate=u.timestamp,setTimeout(()=>{d(T=>{let G=T.nodes.get(v);return G&&(G.isUpdating=!1),{...T}})},l)),{...b}})},[l]),C=(0,I.useCallback)(u=>{d(v=>{let b=w();return x.current.setGraph(b.nodes,b.edges),b})},[w]),E=(0,I.useCallback)(u=>{d(v=>{let b=w();return x.current.setGraph(b.nodes,b.edges),b})},[w]);(0,I.useEffect)(()=>{if(!ve())return;let u=w();d(u),x.current.setGraph(u.nodes,u.edges),x.current.initializePositions();let v=[Re("signal-created",$),Re("signal-updated",ee),Re("signal-destroyed",C),Re("dependency-added",E),Re("dependency-removed",E)];return()=>{v.forEach(b=>b())}},[w,$,ee,C,E]),(0,I.useEffect)(()=>{if(!r||!s)return;let u=()=>{let v=Date.now();v-M.current>=o&&(x.current.tick(),d(b=>({...b})),M.current=v),U.current=requestAnimationFrame(u)};return U.current=requestAnimationFrame(u),()=>{U.current&&cancelAnimationFrame(U.current)}},[r,s,o]);let H=u=>{if(u.isUpdating)return"#ff4444";switch(u.type){case"signal":return"#4CAF50";case"computed":return"#2196F3";case"effect":return"#FF9800";default:return"#9E9E9E"}},p=u=>h===u.id?"#FFD700":"#ffffff",P=u=>new Date(u).toLocaleTimeString(),R=u=>{if(u===null)return"null";if(u===void 0)return"undefined";if(typeof u=="object")try{return JSON.stringify(u).slice(0,50)}catch{return"[Object]"}return String(u).slice(0,50)};return ve()?(0,y.jsxs)("div",{style:{position:"relative",width:t,height:e,background:"#1e1e1e",borderRadius:8},children:[(0,y.jsxs)("svg",{width:t,height:e,children:[(0,y.jsx)("defs",{children:(0,y.jsx)("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"10",refX:"9",refY:"3",orient:"auto",markerUnits:"strokeWidth",children:(0,y.jsx)("path",{d:"M0,0 L0,6 L9,3 z",fill:"#666"})})}),(0,y.jsx)("g",{className:"edges",children:c.edges.map((u,v)=>{let b=c.nodes.get(u.source),f=c.nodes.get(u.target);if(!b||!f)return null;let T=f.x-b.x,G=f.y-b.y,Te=Math.sqrt(T*T+G*G)||1,dn=T/Te*i,un=G/Te*i;return(0,y.jsx)("line",{x1:b.x+dn,y1:b.y+un,x2:f.x-dn,y2:f.y-un,stroke:"#666",strokeWidth:2,markerEnd:"url(#arrowhead)",opacity:h===b.id||h===f.id?1:.3},`${u.source}-${u.target}-${v}`)})}),(0,y.jsx)("g",{className:"nodes",children:Array.from(c.nodes.values()).map(u=>(0,y.jsxs)("g",{onMouseEnter:()=>S(u.id),onMouseLeave:()=>S(null),style:{cursor:"pointer"},children:[(0,y.jsx)("circle",{cx:u.x,cy:u.y,r:i,fill:H(u),stroke:p(u),strokeWidth:h===u.id?3:1,opacity:h&&h!==u.id?.5:1}),n&&(0,y.jsx)("text",{x:u.x,y:u.y+i+15,textAnchor:"middle",fill:"#ffffff",fontSize:"12",fontFamily:"monospace",children:u.label}),u.isUpdating&&(0,y.jsxs)("circle",{cx:u.x,cy:u.y,r:i,fill:"none",stroke:"#ff4444",strokeWidth:2,opacity:.6,children:[(0,y.jsx)("animate",{attributeName:"r",from:i,to:i*2,dur:"0.5s",repeatCount:"indefinite"}),(0,y.jsx)("animate",{attributeName:"opacity",from:"0.6",to:"0",dur:"0.5s",repeatCount:"indefinite"})]})]},u.id))})]}),h&&c.nodes.has(h)&&(0,y.jsx)("div",{style:{position:"absolute",top:10,right:10,background:"rgba(0, 0, 0, 0.9)",color:"#fff",padding:15,borderRadius:8,fontSize:12,fontFamily:"monospace",maxWidth:300,border:"2px solid #FFD700"},children:(()=>{let u=c.nodes.get(h);return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{style:{fontWeight:"bold",marginBottom:8,fontSize:14},children:u.label}),(0,y.jsxs)("div",{style:{marginBottom:4},children:[(0,y.jsx)("strong",{children:"Type:"})," ",u.type]}),(0,y.jsxs)("div",{style:{marginBottom:4},children:[(0,y.jsx)("strong",{children:"ID:"})," ",u.id]}),(0,y.jsxs)("div",{style:{marginBottom:4},children:[(0,y.jsx)("strong",{children:"Value:"})," ",R(u.value)]}),(0,y.jsxs)("div",{style:{marginBottom:4},children:[(0,y.jsx)("strong",{children:"Last Update:"})," ",P(u.lastUpdate)]}),(0,y.jsxs)("div",{style:{marginBottom:4},children:[(0,y.jsx)("strong",{children:"Subscribers:"})," ",u.subscriberCount]}),u.dependencies.length>0&&(0,y.jsxs)("div",{style:{marginBottom:4},children:[(0,y.jsx)("strong",{children:"Dependencies:"}),(0,y.jsx)("ul",{style:{margin:"4px 0",paddingLeft:20},children:u.dependencies.map(v=>{let b=c.nodes.get(v);return(0,y.jsx)("li",{children:b?.label||v},v)})})]}),u.subscribers.length>0&&(0,y.jsxs)("div",{children:[(0,y.jsx)("strong",{children:"Subscribers:"}),(0,y.jsxs)("ul",{style:{margin:"4px 0",paddingLeft:20},children:[u.subscribers.slice(0,5).map(v=>{let b=c.nodes.get(v);return(0,y.jsx)("li",{children:b?.label||v},v)}),u.subscribers.length>5&&(0,y.jsxs)("li",{children:["... and ",u.subscribers.length-5," more"]})]})]})]})})()}),(0,y.jsxs)("div",{style:{position:"absolute",bottom:10,left:10,background:"rgba(0, 0, 0, 0.8)",color:"#fff",padding:10,borderRadius:8,fontSize:11,fontFamily:"sans-serif"},children:[(0,y.jsx)("div",{style:{marginBottom:5,fontWeight:"bold"},children:"Legend"}),(0,y.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:3},children:[(0,y.jsx)("div",{style:{width:12,height:12,background:"#4CAF50",borderRadius:"50%",marginRight:6}}),"Signal"]}),(0,y.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:3},children:[(0,y.jsx)("div",{style:{width:12,height:12,background:"#2196F3",borderRadius:"50%",marginRight:6}}),"Computed"]}),(0,y.jsxs)("div",{style:{display:"flex",alignItems:"center",marginBottom:3},children:[(0,y.jsx)("div",{style:{width:12,height:12,background:"#FF9800",borderRadius:"50%",marginRight:6}}),"Effect"]}),(0,y.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,y.jsx)("div",{style:{width:12,height:12,background:"#ff4444",borderRadius:"50%",marginRight:6}}),"Updating"]})]}),(0,y.jsxs)("div",{style:{position:"absolute",top:10,left:10,background:"rgba(0, 0, 0, 0.8)",color:"#fff",padding:10,borderRadius:8,fontSize:11,fontFamily:"monospace"},children:[(0,y.jsxs)("div",{children:["Signals: ",c.nodes.size]}),(0,y.jsxs)("div",{children:["Edges: ",c.edges.length]})]})]}):(0,y.jsxs)("div",{style:{padding:20,color:"#ff0000"},children:["DevTools is not enabled. Call ",(0,y.jsx)("code",{children:"enableDevTools()"})," to use the visualizer."]})};var Y=require("react");var a=require("react/jsx-runtime"),to=({refreshInterval:t=1e3,maxBatchRecords:e=20,showDetails:n=!0,className:r="",style:o={}})=>{let[s,i]=(0,Y.useState)(null),[l,c]=(0,Y.useState)(null),[d,h]=(0,Y.useState)("mean"),[S,x]=(0,Y.useState)("desc"),[U,M]=(0,Y.useState)(ae()),w=()=>{let p=pe();i(p)};(0,Y.useEffect)(()=>{if(t>0){let p=setInterval(w,t);return()=>clearInterval(p)}},[t]),(0,Y.useEffect)(()=>{w()},[]);let $=()=>{U?it():st(),M(!U),w()},ee=()=>{at(),w()},C=()=>{if(!s)return;let p=JSON.stringify(s,(v,b)=>b instanceof Map?Object.fromEntries(b):b,2),P=new Blob([p],{type:"application/json"}),R=URL.createObjectURL(P),u=document.createElement("a");u.href=R,u.download=`signalforge-performance-${Date.now()}.json`,u.click(),URL.revokeObjectURL(R)},E=(0,Y.useMemo)(()=>s?Array.from(s.signalStats.values()).sort((P,R)=>{let u=P[d],v=R[d],b=u<v?-1:u>v?1:0;return S==="asc"?b:-b}):[],[s,d,S]),H=p=>{d===p?x(S==="asc"?"desc":"asc"):(h(p),x("desc"))};return s?(0,a.jsxs)("div",{className:`performance-tab ${r}`,style:{padding:"20px",fontFamily:"system-ui, sans-serif",...o},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[(0,a.jsx)("h2",{style:{margin:0},children:"Performance Profiler"}),(0,a.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,a.jsx)("button",{onClick:$,style:Ge,children:U?"\u23F8\uFE0F Pause":"\u25B6\uFE0F Start"}),(0,a.jsx)("button",{onClick:ee,style:Ge,children:"\u{1F504} Reset"}),(0,a.jsx)("button",{onClick:C,style:Ge,children:"\u{1F4E5} Export"}),(0,a.jsx)("button",{onClick:w,style:Ge,children:"\u27F3 Refresh"})]})]}),(0,a.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"15px",marginBottom:"30px"},children:[(0,a.jsx)(Le,{title:"Total Signals",value:s.totalSignals,icon:"\u{1F4CA}"}),(0,a.jsx)(Le,{title:"Total Samples",value:s.totalSamples,icon:"\u{1F4C8}"}),(0,a.jsx)(Le,{title:"Total Batches",value:s.batchStats.totalBatches,icon:"\u{1F500}"}),(0,a.jsx)(Le,{title:"Avg Batch Duration",value:`${s.batchStats.avgDuration.toFixed(2)}ms`,icon:"\u23F1\uFE0F"}),(0,a.jsx)(Le,{title:"Session Duration",value:`${(s.duration/1e3).toFixed(1)}s`,icon:"\u23F3"}),(0,a.jsx)(Le,{title:"Status",value:U?"Running":"Paused",icon:U?"\u2705":"\u23F8\uFE0F"})]}),(0,a.jsxs)("section",{style:{marginBottom:"30px"},children:[(0,a.jsx)("h3",{children:"Signal Latency Statistics"}),E.length===0?(0,a.jsx)("p",{style:{color:"#666"},children:"No signals profiled yet. Start using signals to see data."}):(0,a.jsxs)("table",{style:eo,children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsxs)("th",{style:V,onClick:()=>H("signalId"),children:["Signal ID ",d==="signalId"&&(S==="asc"?"\u2191":"\u2193")]}),(0,a.jsx)("th",{style:V,children:"Type"}),(0,a.jsxs)("th",{style:V,onClick:()=>H("sampleCount"),children:["Samples ",d==="sampleCount"&&(S==="asc"?"\u2191":"\u2193")]}),(0,a.jsxs)("th",{style:V,onClick:()=>H("mean"),children:["Mean ",d==="mean"&&(S==="asc"?"\u2191":"\u2193")]}),(0,a.jsx)("th",{style:V,children:"Median"}),(0,a.jsxs)("th",{style:V,onClick:()=>H("p95"),children:["P95 ",d==="p95"&&(S==="asc"?"\u2191":"\u2193")]}),(0,a.jsxs)("th",{style:V,onClick:()=>H("p99"),children:["P99 ",d==="p99"&&(S==="asc"?"\u2191":"\u2193")]}),(0,a.jsxs)("th",{style:V,onClick:()=>H("max"),children:["Max ",d==="max"&&(S==="asc"?"\u2191":"\u2193")]}),(0,a.jsx)("th",{style:V,children:"Skipped"})]})}),(0,a.jsx)("tbody",{children:E.map(p=>(0,a.jsxs)("tr",{style:{backgroundColor:l===p.signalId?"#e3f2fd":"transparent",cursor:"pointer"},onClick:()=>c(p.signalId),children:[(0,a.jsx)("td",{style:z,children:p.signalId}),(0,a.jsx)("td",{style:z,children:p.type}),(0,a.jsx)("td",{style:z,children:p.sampleCount}),(0,a.jsxs)("td",{style:z,children:[p.mean.toFixed(2),"ms"]}),(0,a.jsxs)("td",{style:z,children:[p.median.toFixed(2),"ms"]}),(0,a.jsxs)("td",{style:z,children:[p.p95.toFixed(2),"ms"]}),(0,a.jsxs)("td",{style:z,children:[p.p99.toFixed(2),"ms"]}),(0,a.jsxs)("td",{style:z,children:[p.max.toFixed(2),"ms"]}),(0,a.jsx)("td",{style:z,children:p.skippedCount})]},p.signalId))})]})]}),s.batchRecords.length>0&&(0,a.jsxs)("section",{style:{marginBottom:"30px"},children:[(0,a.jsx)("h3",{children:"Recent Batch Operations"}),(0,a.jsxs)("table",{style:eo,children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{style:V,children:"Batch ID"}),(0,a.jsx)("th",{style:V,children:"Duration"}),(0,a.jsx)("th",{style:V,children:"Operations"}),(0,a.jsx)("th",{style:V,children:"Signals Affected"}),(0,a.jsx)("th",{style:V,children:"Depth"})]})}),(0,a.jsx)("tbody",{children:s.batchRecords.slice(-e).map(p=>(0,a.jsxs)("tr",{children:[(0,a.jsxs)("td",{style:z,children:["#",p.batchId]}),(0,a.jsxs)("td",{style:z,children:[p.duration.toFixed(2),"ms"]}),(0,a.jsx)("td",{style:z,children:p.operationCount}),(0,a.jsx)("td",{style:z,children:p.affectedSignals.length}),(0,a.jsx)("td",{style:z,children:p.depth})]},p.batchId))})]})]}),n&&l&&(0,a.jsxs)("section",{style:{marginTop:"30px",padding:"15px",backgroundColor:"#f5f5f5",borderRadius:"8px"},children:[(0,a.jsxs)("h3",{children:["Signal Details: ",l]}),(()=>{let p=s.signalStats.get(l);return p?(0,a.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Type:"})," ",p.type]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Sample Count:"})," ",p.sampleCount]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Min Latency:"})," ",p.min.toFixed(2),"ms"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Max Latency:"})," ",p.max.toFixed(2),"ms"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Mean Latency:"})," ",p.mean.toFixed(2),"ms"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Median Latency:"})," ",p.median.toFixed(2),"ms"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"P95 Latency:"})," ",p.p95.toFixed(2),"ms"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"P99 Latency:"})," ",p.p99.toFixed(2),"ms"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Std Deviation:"})," ",p.stdDev.toFixed(2),"ms"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Avg Subscribers:"})," ",p.avgSubscribers.toFixed(1)]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Skipped Updates:"})," ",p.skippedCount]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Effective Updates:"})," ",p.sampleCount-p.skippedCount]})]}):null})(),(0,a.jsx)("button",{onClick:()=>c(null),style:{...Ge,marginTop:"15px"},children:"Close Details"})]})]}):(0,a.jsx)("div",{className:`performance-tab ${r}`,style:{padding:"20px",...o},children:(0,a.jsx)("p",{children:"Loading profiler data..."})})},Le=({title:t,value:e,icon:n})=>(0,a.jsxs)("div",{style:{padding:"15px",backgroundColor:"#fff",border:"1px solid #e0e0e0",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[(0,a.jsx)("div",{style:{fontSize:"24px",marginBottom:"5px"},children:n}),(0,a.jsx)("div",{style:{fontSize:"12px",color:"#666",marginBottom:"5px"},children:t}),(0,a.jsx)("div",{style:{fontSize:"20px",fontWeight:"bold"},children:e})]}),Ge={padding:"8px 16px",backgroundColor:"#2196F3",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"14px"},eo={width:"100%",borderCollapse:"collapse",backgroundColor:"#fff",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},V={padding:"12px",backgroundColor:"#f5f5f5",borderBottom:"2px solid #e0e0e0",textAlign:"left",fontWeight:"bold",cursor:"pointer",userSelect:"none"},z={padding:"10px 12px",borderBottom:"1px solid #e0e0e0"};var Me=!1,N=null,Se=[],ke=0,ts=0,je=null,ro={transport:"flipper",preferFlipper:!0,websocketUrl:"ws://localhost:8097",autoEnable:!0,batchInterval:100,maxQueueSize:1e3,verbose:!1},Q={...ro};async function oo(t){if(!Me){if(Q={...ro,...t},!ns()){B("Bridge disabled (production build or autoEnable=false)"),N=new qe,Me=!0;return}ve()||Yr({trackPerformance:!0,emitPerformanceWarnings:!0}),N=await rs();try{await N.connect(),B(`Bridge connected via ${N.type}`)}catch(e){console.error("[NativeBridge] Connection failed:",e),N=new qe}N.onMessage(ss),as(),await lo(),Me=!0,B("Bridge initialized successfully")}}async function so(){Me&&(co(),N&&(await N.disconnect(),N=null),Se=[],ke=0,Me=!1,B("Bridge shutdown"))}function io(){return Me&&N!==null&&N.isConnected()}function ao(){return Q}function ns(){return Q.autoEnable,!1}async function rs(){if(Q.transport==="websocket")return new Et(Q.websocketUrl);if(Q.transport==="mock")return new qe;if(Q.preferFlipper&&os())try{let t=new sn;return await t.connect(),t}catch{B("Flipper not available, falling back to WebSocket")}return new Et(Q.websocketUrl)}function os(){try{return!!require("react-native-flipper")}catch{return!1}}function ss(t){B("Received message:",t.type),t.type==="command"&&is(t)}async function is(t){let{command:e,args:n}=t.payload,r;try{let o;switch(e){case"listSignals":o=re();break;case"getSignal":o=wt(n[0]);break;case"getDependencyGraph":o=oe();break;case"getPerformanceMetrics":o=be(n[0]);break;case"getProfilerData":o=pe();break;case"requestSnapshot":await lo(),o={success:!0};break;default:throw new Error(`Unknown command: ${e}`)}r=no(t.id,!0,o)}catch(o){r=no(t.id,!1,void 0,o instanceof Error?o.message:"Unknown error")}await We(r)}function as(){B("Event listeners setup complete")}async function lo(){let t={type:"snapshot",id:Ke(),seq:ke++,timestamp:Date.now(),payload:{signals:re(),dependencies:oe(),performance:be(),profiler:pe()}};await We(t),B("Snapshot sent")}async function We(t){if(!N||!N.isConnected()){B("Transport not connected, message dropped");return}Se.push(t),Se.length>Q.maxQueueSize&&(Se.shift(),B("Queue full, dropped oldest message")),je||(je=setTimeout(co,Q.batchInterval))}function co(){if(je&&(clearTimeout(je),je=null),Se.length===0||!N)return;let t=[...Se];Se=[],Promise.all(t.map(e=>N.send(e))).catch(e=>{console.error("[NativeBridge] Failed to send messages:",e)})}function no(t,e,n,r){return{type:"response",id:Ke(),seq:ke++,timestamp:Date.now(),payload:{commandId:t,success:e,data:n,error:r}}}function Ke(){return`msg_${++ts}_${Date.now()}`}function B(...t){Q.verbose&&[...t]}var sn=class{constructor(){this.type="flipper";this.connected=!1;this.flipperConnection=null;this.messageHandler=null}isConnected(){return this.connected}async connect(){try{let{addPlugin:e}=require("react-native-flipper");e({getId:()=>"SignalForge",onConnect:n=>{this.flipperConnection=n,this.connected=!0,n.receive("command",r=>{this.messageHandler&&this.messageHandler(r)}),B("Flipper connected")},onDisconnect:()=>{this.connected=!1,this.flipperConnection=null,B("Flipper disconnected")},runInBackground:()=>!0})}catch(e){throw new Error(`Flipper connection failed: ${e}`)}}async disconnect(){this.connected=!1,this.flipperConnection=null}async send(e){if(!this.flipperConnection)throw new Error("Flipper not connected");this.flipperConnection.send(e.type,e)}onMessage(e){this.messageHandler=e}},Et=class{constructor(e){this.url=e;this.type="websocket";this.connected=!1;this.ws=null;this.messageHandler=null;this.reconnectTimer=null;this.reconnectAttempts=0;this.maxReconnectAttempts=5}isConnected(){return this.connected&&this.ws!==null&&this.ws.readyState===WebSocket.OPEN}async connect(){return new Promise((e,n)=>{try{this.ws=new WebSocket(this.url),this.ws.onopen=()=>{this.connected=!0,this.reconnectAttempts=0,B("WebSocket connected"),e()},this.ws.onclose=()=>{this.connected=!1,B("WebSocket closed"),this.attemptReconnect()},this.ws.onerror=r=>{console.error("[NativeBridge] WebSocket error:",r),n(r)},this.ws.onmessage=r=>{try{let o=JSON.parse(r.data);this.messageHandler&&this.messageHandler(o)}catch(o){console.error("[NativeBridge] Failed to parse message:",o)}}}catch(r){n(r)}})}async disconnect(){this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.ws&&(this.ws.close(),this.ws=null),this.connected=!1}async send(e){if(!this.ws||this.ws.readyState!==WebSocket.OPEN)throw new Error("WebSocket not connected");let n=JSON.stringify(e);this.ws.send(n)}onMessage(e){this.messageHandler=e}attemptReconnect(){if(this.reconnectAttempts>=this.maxReconnectAttempts){B("Max reconnect attempts reached");return}this.reconnectAttempts++;let e=Math.min(1e3*Math.pow(2,this.reconnectAttempts),3e4);B(`Reconnecting in ${e}ms (attempt ${this.reconnectAttempts})`),this.reconnectTimer=setTimeout(()=>{this.connect().catch(n=>{console.error("[NativeBridge] Reconnect failed:",n)})},e)}},qe=class{constructor(){this.type="mock"}isConnected(){return!1}async connect(){}async disconnect(){}async send(e){}onMessage(e){}};async function uo(t,e){let n={type:"signal-created",id:Ke(),seq:ke++,timestamp:Date.now(),payload:{signalId:t,metadata:e}};await We(n)}async function go(t,e,n){let r={type:"signal-updated",id:Ke(),seq:ke++,timestamp:Date.now(),payload:{signalId:t,previousValue:e,newValue:n}};await We(r)}async function po(t){let e={type:"performance-metric",id:Ke(),seq:ke++,timestamp:Date.now(),payload:t};await We(e)}var Je=class{constructor(e={}){this.snapshots=[];this.currentIndex=-1;this.snapshotIdCounter=0;this.signalValues=new Map;this.signalRefs=new Map;this.enabled=!0;this.isRestoring=!1;this.config={maxHistory:er(e.maxHistory),fullSnapshotInterval:e.fullSnapshotInterval??10,enableCompression:e.enableCompression??!0,verbose:e.verbose??!1}}getPlugin(){return{name:"time-travel",version:Qn,onRegister:()=>{this.log("\u23F1\uFE0F  Time Travel plugin activated"),this.log(`   Max history: ${this.config.maxHistory}`),this.log(`   Full snapshot interval: ${this.config.fullSnapshotInterval}`)},onSignalCreate:(e,n)=>{this.signalValues.set(e.id,n),this.log(`\u{1F4CC} Tracking signal: ${e.label||e.id}`)},onSignalUpdate:e=>{!this.enabled||this.isRestoring||(this.signalValues.set(e.signal.id,e.newValue),this.recordSnapshot(e))},onUnregister:()=>{this.log("\u23F1\uFE0F  Time Travel plugin deactivated"),this.log(`   Recorded ${this.snapshots.length} snapshots`),this.clear()}}}undo(){if(!this.canUndo())return this.log("\u23EA Cannot undo: at beginning of history"),!1;let e=this.snapshots[this.currentIndex],n=this.restoreState(this.currentIndex,"undo");return n&&(this.currentIndex--,this.log(`\u23EA Undo: ${e.signalLabel||e.signalId} \u2192 ${this.formatValue(e.oldValue)}`)),n}redo(){if(!this.canRedo())return this.log("\u23E9 Cannot redo: at end of history"),!1;this.currentIndex++;let e=this.snapshots[this.currentIndex],n=this.restoreState(this.currentIndex,"redo");return n&&this.log(`\u23E9 Redo: ${e.signalLabel||e.signalId} \u2192 ${this.formatValue(e.newValue)}`),n}jumpTo(e){if(e<0||e>=this.snapshots.length)return this.log(`\u274C Invalid index: ${e} (max: ${this.snapshots.length-1})`),!1;this.currentIndex=e;let n=this.restoreState(e);if(n){let r=this.snapshots[e];this.log(`\u{1F3AF} Jump to snapshot #${r.id}: ${r.signalLabel||r.signalId}`)}return n}canUndo(){return this.currentIndex>=0}canRedo(){return this.currentIndex<this.snapshots.length-1}getCurrentIndex(){return this.currentIndex}getSnapshotCount(){return this.snapshots.length}getTimelineState(){return{total:this.snapshots.length,current:this.currentIndex,canUndo:this.canUndo(),canRedo:this.canRedo(),snapshots:this.snapshots.map(e=>({id:e.id,timestamp:e.timestamp,signalId:e.signalId,signalLabel:e.signalLabel,preview:this.formatValue(e.newValue)}))}}getSnapshots(){return[...this.snapshots]}getSnapshotsForSignal(e){return this.snapshots.filter(n=>n.signalId===e)}getSnapshotAt(e){return this.snapshots[e]}getCurrentSnapshot(){return this.snapshots[this.currentIndex]}exportSession(){return{timestamp:Date.now(),version:"1.0.0",snapshots:[...this.snapshots],currentIndex:this.currentIndex}}importSession(e){this.snapshots=[...e.snapshots],this.currentIndex=e.currentIndex,this.snapshotIdCounter=Math.max(...this.snapshots.map(n=>n.id),0)+1,this.log(`\u{1F4E5} Imported session with ${this.snapshots.length} snapshots`)}clear(){this.snapshots=[],this.currentIndex=-1,this.snapshotIdCounter=0,this.signalValues.clear(),this.log("\u{1F5D1}\uFE0F  History cleared")}setEnabled(e){this.enabled=e,this.log(`${e?"\u25B6\uFE0F":"\u23F8\uFE0F"}  Recording ${e?"enabled":"paused"}`)}isEnabled(){return this.enabled}recordSnapshot(e){let n=this.snapshots.length,r=n%this.config.fullSnapshotInterval===0,o={id:this.snapshotIdCounter++,timestamp:Date.now(),signalId:e.signal.id,signalLabel:e.signal.label,signalType:e.signal.type,oldValue:e.oldValue,newValue:e.newValue,isFull:r,index:n};if(!r&&this.config.enableCompression&&(o.diff=this.computeDiff(e.oldValue,e.newValue)),this.currentIndex<this.snapshots.length-1&&(this.snapshots=this.snapshots.slice(0,this.currentIndex+1),this.log(`\u2702\uFE0F  Discarded ${this.snapshots.length-this.currentIndex-1} future snapshots`)),this.snapshots.push(o),this.currentIndex=this.snapshots.length-1,this.snapshots.length>this.config.maxHistory){let s=this.snapshots.shift();this.currentIndex--,this.log(`\u{1F4E6} Pruned old snapshot #${s?.id}`)}this.log(`\u{1F4F8} Snapshot #${o.id}: ${o.signalLabel||o.signalId} = ${this.formatValue(o.newValue)}`)}restoreState(e,n="jump"){if(e<0||e>=this.snapshots.length)return!1;let r=this.snapshots[e],o=Mn(r.signalId);if(!o)return this.log(`\u26A0\uFE0F  Signal ${r.signalId} not found in registry`),this.signalValues.set(r.signalId,r.newValue),!1;let s;n==="undo"?s=r.oldValue:s=r.newValue,this.isRestoring=!0;try{return o.set(s),this.signalValues.set(r.signalId,s),!0}catch(i){return console.error(`[TimeTravel] Error restoring signal ${r.signalId}:`,i),!1}finally{this.isRestoring=!1}}computeDiff(e,n){if(this.isPrimitive(e)||this.isPrimitive(n))return{type:"primitive",oldValue:e,newValue:n};if(Array.isArray(e)&&Array.isArray(n))return{type:"array",added:n.filter((r,o)=>o>=e.length),removed:e.length>n.length?Array.from({length:e.length-n.length},(r,o)=>e.length-1-o):[],changed:this.computeArrayDiff(e,n)};if(typeof e=="object"&&typeof n=="object"){let r=Object.keys(e),o=Object.keys(n),s={},i=[],l={};for(let c of o)r.includes(c)||(s[c]=n[c]);for(let c of r)o.includes(c)||i.push(c);for(let c of o)r.includes(c)&&!this.isEqual(e[c],n[c])&&(l[c]={old:e[c],new:n[c]});return{type:"object",added:s,removed:i,changed:l}}return{type:"primitive",oldValue:e,newValue:n}}computeArrayDiff(e,n){let r={},o=Math.min(e.length,n.length);for(let s=0;s<o;s++)this.isEqual(e[s],n[s])||(r[s.toString()]={old:e[s],new:n[s]});return r}isPrimitive(e){return e==null||typeof e!="object"}isEqual(e,n){if(e===n)return!0;if(e==null||n==null||typeof e!=typeof n||typeof e!="object")return!1;let r=Object.keys(e),o=Object.keys(n);return r.length!==o.length?!1:r.every(s=>this.isEqual(e[s],n[s]))}formatValue(e){if(e==null)return String(e);if(typeof e=="string")return`"${e}"`;if(typeof e=="object"){let n=JSON.stringify(e);return nr(n,50)}return String(e)}log(...e){this.config.verbose&&[...e]}};function Rt(t){let e=JSON.stringify(t);return new Blob([e]).size}function Lt(t){return t<1024?`${t} B`:t<1024*1024?`${(t/1024).toFixed(1)} KB`:`${(t/(1024*1024)).toFixed(1)} MB`}function fo(t){return new Je(t)}var De=require("react");var m=require("react/jsx-runtime"),mo=({plugin:t,refreshInterval:e=1e3,showDetails:n=!0,className:r="",style:o={}})=>{let[s,i]=(0,De.useState)(null),[l,c]=(0,De.useState)(null),[d,h]=(0,De.useState)("0 B"),S=()=>{let p=t.getTimelineState();i(p);let P=t.getSnapshots(),R=Rt(P);h(Lt(R))};(0,De.useEffect)(()=>{if(S(),e>0){let p=setInterval(S,e);return()=>clearInterval(p)}},[e]);let x=()=>{t.undo(),S()},U=()=>{t.redo(),S()},M=p=>{t.jumpTo(p),S()},w=p=>{let P=parseInt(p.target.value,10);M(P)},$=p=>{let P=t.getSnapshotAt(p);c(P||null)},ee=()=>{let p=t.exportSession(),P=JSON.stringify(p,null,2),R=new Blob([P],{type:"application/json"}),u=URL.createObjectURL(R),v=document.createElement("a");v.href=u,v.download=`time-travel-session-${Date.now()}.json`,v.click(),URL.revokeObjectURL(u)},C=()=>{let p=document.createElement("input");p.type="file",p.accept="application/json",p.onchange=P=>{let R=P.target.files?.[0];if(!R)return;let u=new FileReader;u.onload=v=>{try{let b=JSON.parse(v.target?.result);t.importSession(b),S()}catch(b){alert("Failed to import session: "+b)}},u.readAsText(R)},p.click()},E=()=>{confirm("Clear all history?")&&(t.clear(),c(null),S())},H=()=>{t.setEnabled(!t.isEnabled()),S()};return s?(0,m.jsxs)("div",{className:`time-travel-timeline ${r}`,style:{padding:"20px",fontFamily:"system-ui, sans-serif",...o},children:[(0,m.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[(0,m.jsx)("h2",{style:{margin:0},children:"\u23F1\uFE0F Time Travel"}),(0,m.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,m.jsx)("button",{onClick:H,style:se,children:t.isEnabled()?"\u23F8\uFE0F Pause":"\u25B6\uFE0F Record"}),(0,m.jsx)("button",{onClick:ee,style:se,disabled:s.total===0,children:"\u{1F4E5} Export"}),(0,m.jsx)("button",{onClick:C,style:se,children:"\u{1F4E4} Import"}),(0,m.jsx)("button",{onClick:E,style:se,disabled:s.total===0,children:"\u{1F5D1}\uFE0F Clear"})]})]}),(0,m.jsxs)("div",{style:{display:"flex",gap:"20px",marginBottom:"20px",fontSize:"14px",color:"#666"},children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("strong",{children:"Snapshots:"})," ",s.total]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("strong",{children:"Position:"})," ",s.current+1," / ",s.total]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("strong",{children:"Memory:"})," ",d]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("strong",{children:"Status:"})," ",t.isEnabled()?"\u{1F7E2} Recording":"\u23F8\uFE0F Paused"]})]}),(0,m.jsxs)("div",{style:{display:"flex",gap:"10px",marginBottom:"20px"},children:[(0,m.jsx)("button",{onClick:x,disabled:!s.canUndo,style:{...se,flex:1},children:"\u23EA Undo"}),(0,m.jsx)("button",{onClick:U,disabled:!s.canRedo,style:{...se,flex:1},children:"\u23E9 Redo"}),(0,m.jsx)("button",{onClick:()=>M(0),disabled:s.total===0||s.current===0,style:{...se,flex:1},children:"\u23EE\uFE0F Start"}),(0,m.jsx)("button",{onClick:()=>M(s.total-1),disabled:s.total===0||s.current===s.total-1,style:{...se,flex:1},children:"\u23ED\uFE0F End"})]}),s.total>0&&(0,m.jsxs)("div",{style:{marginBottom:"30px"},children:[(0,m.jsx)("input",{type:"range",min:"0",max:s.total-1,value:s.current,onChange:w,style:{width:"100%",height:"8px",borderRadius:"4px",outline:"none",cursor:"pointer"}}),(0,m.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",fontSize:"12px",color:"#999",marginTop:"5px"},children:[(0,m.jsx)("span",{children:"Start"}),(0,m.jsxs)("span",{children:["Position: ",s.current+1]}),(0,m.jsx)("span",{children:"End"})]})]}),(0,m.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,m.jsx)("h3",{style:{marginBottom:"10px"},children:"Snapshots"}),s.total===0?(0,m.jsx)("p",{style:{color:"#666"},children:"No snapshots recorded yet. Start using signals to see history."}):(0,m.jsx)("div",{style:{maxHeight:"400px",overflowY:"auto",border:"1px solid #e0e0e0",borderRadius:"4px"},children:s.snapshots.map((p,P)=>(0,m.jsxs)("div",{onClick:()=>$(P),style:{padding:"12px",borderBottom:"1px solid #f0f0f0",cursor:"pointer",backgroundColor:P===s.current?"#e3f2fd":"transparent",transition:"background-color 0.2s"},onMouseEnter:R=>{P!==s.current&&(R.currentTarget.style.backgroundColor="#f5f5f5")},onMouseLeave:R=>{P!==s.current&&(R.currentTarget.style.backgroundColor="transparent")},children:[(0,m.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,m.jsxs)("div",{children:[(0,m.jsxs)("strong",{children:["#",p.id]})," ",p.signalLabel||p.signalId]}),(0,m.jsx)("div",{style:{fontSize:"12px",color:"#666"},children:new Date(p.timestamp).toLocaleTimeString()})]}),(0,m.jsx)("div",{style:{fontSize:"14px",color:"#555",marginTop:"4px"},children:p.preview})]},p.id))})]}),n&&l&&(0,m.jsxs)("div",{style:{padding:"15px",backgroundColor:"#f9f9f9",borderRadius:"8px",border:"1px solid #e0e0e0"},children:[(0,m.jsx)("h3",{style:{marginTop:0},children:"Snapshot Details"}),(0,m.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",fontSize:"14px"},children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("strong",{children:"ID:"})," #",l.id]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("strong",{children:"Index:"})," ",l.index]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("strong",{children:"Signal:"})," ",l.signalLabel||l.signalId]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("strong",{children:"Type:"})," ",l.signalType]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("strong",{children:"Time:"})," ",new Date(l.timestamp).toLocaleString()]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("strong",{children:"Is Full:"})," ",l.isFull?"Yes":"No (Diff)"]})]}),(0,m.jsxs)("div",{style:{marginTop:"15px"},children:[(0,m.jsx)("div",{style:{marginBottom:"5px"},children:(0,m.jsx)("strong",{children:"Old Value:"})}),(0,m.jsx)("pre",{style:an,children:JSON.stringify(l.oldValue,null,2)})]}),(0,m.jsxs)("div",{style:{marginTop:"15px"},children:[(0,m.jsx)("div",{style:{marginBottom:"5px"},children:(0,m.jsx)("strong",{children:"New Value:"})}),(0,m.jsx)("pre",{style:an,children:JSON.stringify(l.newValue,null,2)})]}),l.diff&&(0,m.jsxs)("div",{style:{marginTop:"15px"},children:[(0,m.jsx)("div",{style:{marginBottom:"5px"},children:(0,m.jsx)("strong",{children:"Diff:"})}),(0,m.jsx)("pre",{style:an,children:JSON.stringify(l.diff,null,2)})]}),(0,m.jsx)("button",{onClick:()=>c(null),style:{...se,marginTop:"15px"},children:"Close"})]})]}):(0,m.jsx)("div",{style:{padding:"20px"},children:"Loading..."})},se={padding:"8px 16px",backgroundColor:"#2196F3",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"14px",transition:"background-color 0.2s"},an={backgroundColor:"#f5f5f5",padding:"10px",borderRadius:"4px",fontSize:"12px",fontFamily:"monospace",overflow:"auto",maxHeight:"200px"};var de=class{constructor(e={}){this.logs=[];this.logCounter=0;this.signalRegistry=new Map;this.options={level:e.level||"info",maxLogs:tr(e.maxLogs),enableConsole:e.enableConsole!==!1,filter:e.filter||(()=>!0),signalPattern:e.signalPattern||/.*/,signalIds:e.signalIds||[],includeStackTrace:e.includeStackTrace||!1,verbose:e.verbose||!1,formatter:e.formatter||this.defaultFormatter.bind(this)}}getPlugin(){return{name:"logger",version:"2.0.0",onRegister:()=>{this.logInternal("info","Logger plugin registered","create")},onSignalCreate:(e,n)=>{this.signalRegistry.set(e.id,e);let r=this.createLogEntry({type:"create",level:"info",signalId:e.id,signalLabel:e.label,metadata:e,newValue:n,message:`Signal created: ${e.label||e.id}`});this.addLog(r)},onSignalUpdate:e=>{let n=this.signalRegistry.get(e.signal.id)||e.signal,r=this.createLogEntry({type:"update",level:"debug",signalId:e.signal.id,signalLabel:n.label,metadata:n,oldValue:e.oldValue,newValue:e.newValue,message:`Signal updated: ${n.label||e.signal.id}`});this.addLog(r)},onSignalDestroy:e=>{let n=this.createLogEntry({type:"destroy",level:"info",signalId:e.id,signalLabel:e.label,metadata:e,message:`Signal destroyed: ${e.label||e.id}`});this.addLog(n),this.signalRegistry.delete(e.id)},onUnregister:()=>{this.logInternal("info","Logger plugin unregistered","destroy")}}}createLogEntry(e){let n={id:`log_${++this.logCounter}`,timestamp:Date.now(),type:e.type||"update",level:e.level||"info",signalId:e.signalId||"unknown",signalLabel:e.signalLabel,metadata:e.metadata,oldValue:e.oldValue,newValue:e.newValue,message:e.message};return this.options.includeStackTrace&&(n.stack=new Error().stack?.split(`
`).slice(3).join(`
`)),n}addLog(e){this.shouldLog(e)&&(this.logs.push(e),this.logs.length>this.options.maxLogs&&this.logs.shift(),this.options.enableConsole&&this.logToConsole(e))}shouldLog(e){if(!this.isLevelEnabled(e.level)||this.options.signalIds.length>0&&!this.options.signalIds.includes(e.signalId))return!1;let n=e.signalLabel||e.signalId;return!(!this.options.signalPattern.test(n)||!this.options.filter(e))}isLevelEnabled(e){let n=["debug","info","warn","error","off"],r=n.indexOf(this.options.level);return n.indexOf(e)>=r}logInternal(e,n,r){let o=this.createLogEntry({type:r,level:e,signalId:"__logger__",signalLabel:"Logger",message:n});this.logs.push(o),this.options.enableConsole&&this.logToConsole(o)}logToConsole(e){let n=this.options.formatter(e);switch(e.level){case"debug":console.debug(n);break;case"info":console.info(n);break;case"warn":break;case"error":console.error(n);break}this.options.verbose&&e.type==="update"&&(e.oldValue,e.newValue)}defaultFormatter(e){let n=new Date(e.timestamp).toISOString(),r=e.signalLabel||e.signalId,o=this.getLogIcon(e.type),s=`[${n}] ${o} ${r}`;if(e.type==="update"){let i=this.formatValue(e.oldValue),l=this.formatValue(e.newValue);s+=` | ${i} \u2192 ${l}`}else if(e.type==="create"){let i=this.formatValue(e.newValue);s+=` = ${i}`}return e.message&&e.type==="destroy"&&(s+=` | ${e.message}`),s}getLogIcon(e){switch(e){case"create":return"\u{1F7E2}";case"update":return"\u{1F535}";case"destroy":return"\u{1F534}";default:return"\u26AA"}}formatValue(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="object")try{let n=JSON.stringify(e);return n.length>50?n.substring(0,47)+"...":n}catch{return"[Object]"}return String(e)}getLogs(){return[...this.logs]}getLogsFiltered(e){return this.logs.filter(n=>{if(e.type&&n.type!==e.type||e.level&&n.level!==e.level||e.signalId&&n.signalId!==e.signalId)return!1;if(e.signalPattern){let r=n.signalLabel||n.signalId;if(!e.signalPattern.test(r))return!1}return!(e.startTime&&n.timestamp<e.startTime||e.endTime&&n.timestamp>e.endTime)})}getLogById(e){return this.logs.find(n=>n.id===e)}getLogsForSignal(e){return this.logs.filter(n=>n.signalId===e)}getStats(){let e={total:this.logs.length,byType:{create:0,update:0,destroy:0},byLevel:{debug:0,info:0,warn:0,error:0,off:0},bySignal:{}};return this.logs.forEach(n=>{e.byType[n.type]++,e.byLevel[n.level]++;let r=n.signalLabel||n.signalId;e.bySignal[r]=(e.bySignal[r]||0)+1,(!e.oldestTimestamp||n.timestamp<e.oldestTimestamp)&&(e.oldestTimestamp=n.timestamp),(!e.newestTimestamp||n.timestamp>e.newestTimestamp)&&(e.newestTimestamp=n.timestamp)}),e}getSignalIds(){let e=new Set;return this.logs.forEach(n=>e.add(n.signalId)),Array.from(e)}getSignalLabels(){let e=new Set;return this.logs.forEach(n=>{n.signalLabel&&e.add(n.signalLabel)}),Array.from(e)}setOptions(e){Object.assign(this.options,e)}setLevel(e){this.options.level=e}setSignalPattern(e){this.options.signalPattern=e}setSignalIds(e){this.options.signalIds=e}setConsoleEnabled(e){this.options.enableConsole=e}setVerbose(e){this.options.verbose=e}clear(){this.logs=[],this.logCounter=0}exportLogs(){return JSON.stringify({timestamp:Date.now(),options:this.options,logs:this.logs,stats:this.getStats()},null,2)}importLogs(e){try{let n=JSON.parse(e);n.logs&&Array.isArray(n.logs)&&(this.logs=n.logs,this.logCounter=this.logs.length)}catch(n){console.error("Failed to import logs:",n)}}search(e){let n=e.toLowerCase();return this.logs.filter(r=>{let o=(r.signalLabel||r.signalId).toLowerCase(),s=(r.message||"").toLowerCase(),i=this.formatValue(r.oldValue).toLowerCase(),l=this.formatValue(r.newValue).toLowerCase();return o.includes(n)||s.includes(n)||i.includes(n)||l.includes(n)})}};function yo(t){return new de(t)}function ho(){return new de({level:"warn",enableConsole:!0,maxLogs:100})}function bo(){return new de({level:"debug",enableConsole:!0,verbose:!0,includeStackTrace:!0,maxLogs:5e3})}function vo(t,e){return new de({...e,signalPattern:t})}var D=Mo(require("react")),g=require("react/jsx-runtime");function To({plugin:t,refreshInterval:e=500,maxDisplayLogs:n=200,showStats:r=!0,autoScroll:o=!0,style:s}){let[i,l]=(0,D.useState)([]),[c,d]=(0,D.useState)([]),[h,S]=(0,D.useState)(""),[x,U]=(0,D.useState)("all"),[M,w]=(0,D.useState)("all"),[$,ee]=(0,D.useState)("all"),[C,E]=(0,D.useState)(null),H=(0,D.useRef)(null);(0,D.useEffect)(()=>{let f=()=>{let G=t.getLogs();l(G)};f();let T=setInterval(f,e);return()=>clearInterval(T)},[t,e]),(0,D.useEffect)(()=>{let f=[...i];x!=="all"&&(f=f.filter(T=>T.type===x)),M!=="all"&&(f=f.filter(T=>T.level===M)),$!=="all"&&(f=f.filter(T=>(T.signalLabel||T.signalId)===$)),h&&(f=t.search(h),x!=="all"&&(f=f.filter(T=>T.type===x)),M!=="all"&&(f=f.filter(T=>T.level===M)),$!=="all"&&(f=f.filter(T=>(T.signalLabel||T.signalId)===$))),f.length>n&&(f=f.slice(-n)),d(f)},[i,h,x,M,$,n,t]),(0,D.useEffect)(()=>{o&&H.current?.scrollIntoView({behavior:"smooth"})},[c,o]);let p=D.default.useMemo(()=>{let f=new Set;return i.forEach(T=>{let G=T.signalLabel||T.signalId;f.add(G)}),Array.from(f).sort()},[i]),P=D.default.useMemo(()=>t.getStats(),[i,t]),R=()=>{t.clear(),l([]),d([]),E(null)},u=()=>{let f=t.exportLogs(),T=new Blob([f],{type:"application/json"}),G=URL.createObjectURL(T),Te=document.createElement("a");Te.href=G,Te.download=`signalforge-logs-${Date.now()}.json`,Te.click(),URL.revokeObjectURL(G)},v=f=>{E(f)},b=()=>{E(null)};return(0,g.jsxs)("div",{style:{...gs,...s},children:[(0,g.jsxs)("div",{style:ps,children:[(0,g.jsx)("h3",{style:{margin:0},children:"\u{1F4DD} Signal Logger"}),(0,g.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,g.jsx)("button",{onClick:R,style:So,children:"\u{1F5D1}\uFE0F Clear"}),(0,g.jsx)("button",{onClick:u,style:So,children:"\u{1F4BE} Export"})]})]}),r&&(0,g.jsxs)("div",{style:fs,children:[(0,g.jsxs)("div",{style:Xe,children:[(0,g.jsx)("strong",{children:"Total:"})," ",P.total]}),(0,g.jsxs)("div",{style:Xe,children:[(0,g.jsx)("strong",{children:"Creates:"})," ",P.byType.create]}),(0,g.jsxs)("div",{style:Xe,children:[(0,g.jsx)("strong",{children:"Updates:"})," ",P.byType.update]}),(0,g.jsxs)("div",{style:Xe,children:[(0,g.jsx)("strong",{children:"Destroys:"})," ",P.byType.destroy]}),(0,g.jsxs)("div",{style:Xe,children:[(0,g.jsx)("strong",{children:"Signals:"})," ",Object.keys(P.bySignal).length]})]}),(0,g.jsxs)("div",{style:ms,children:[(0,g.jsx)("input",{type:"text",placeholder:"\u{1F50D} Search logs...",value:h,onChange:f=>S(f.target.value),style:ys}),(0,g.jsxs)("select",{value:x,onChange:f=>U(f.target.value),style:cn,children:[(0,g.jsx)("option",{value:"all",children:"All Types"}),(0,g.jsx)("option",{value:"create",children:"\u{1F7E2} Create"}),(0,g.jsx)("option",{value:"update",children:"\u{1F535} Update"}),(0,g.jsx)("option",{value:"destroy",children:"\u{1F534} Destroy"})]}),(0,g.jsxs)("select",{value:M,onChange:f=>w(f.target.value),style:cn,children:[(0,g.jsx)("option",{value:"all",children:"All Levels"}),(0,g.jsx)("option",{value:"debug",children:"Debug"}),(0,g.jsx)("option",{value:"info",children:"Info"}),(0,g.jsx)("option",{value:"warn",children:"Warning"}),(0,g.jsx)("option",{value:"error",children:"Error"})]}),(0,g.jsxs)("select",{value:$,onChange:f=>ee(f.target.value),style:cn,children:[(0,g.jsx)("option",{value:"all",children:"All Signals"}),p.map(f=>(0,g.jsx)("option",{value:f,children:f},f))]})]}),(0,g.jsx)("div",{style:hs,children:c.length===0?(0,g.jsx)("div",{style:vs,children:i.length===0?(0,g.jsx)(g.Fragment,{children:"\u{1F4ED} No logs yet. Signals will be logged here."}):(0,g.jsx)(g.Fragment,{children:"\u{1F50D} No logs match your filters."})}):(0,g.jsxs)(g.Fragment,{children:[c.map(f=>(0,g.jsx)(ds,{log:f,onClick:()=>v(f),isSelected:C?.id===f.id},f.id)),(0,g.jsx)("div",{ref:H})]})}),C&&(0,g.jsx)(us,{log:C,onClose:b})]})}function ds({log:t,onClick:e,isSelected:n}){let r=xo(t.type),o=new Date(t.timestamp).toLocaleTimeString(),s=t.signalLabel||t.signalId,i={...bs,backgroundColor:n?"#e3f2fd":t.level==="error"?"#ffebee":t.level==="warn"?"#fff3e0":"#fff",borderLeft:n?"3px solid #2196F3":"none"};return(0,g.jsxs)("div",{style:i,onClick:e,children:[(0,g.jsx)("span",{style:{fontSize:"14px"},children:r}),(0,g.jsx)("span",{style:{color:"#666",fontSize:"12px",minWidth:"80px"},children:o}),(0,g.jsx)("span",{style:{fontWeight:500,flex:1},children:s}),t.type==="update"&&(0,g.jsxs)("span",{style:{fontSize:"12px",color:"#666"},children:[ln(t.oldValue)," \u2192 ",ln(t.newValue)]}),t.type==="create"&&(0,g.jsxs)("span",{style:{fontSize:"12px",color:"#666"},children:["= ",ln(t.newValue)]})]})}function us({log:t,onClose:e}){return(0,g.jsx)("div",{style:Ss,children:(0,g.jsxs)("div",{style:Ts,children:[(0,g.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"15px"},children:[(0,g.jsx)("h4",{style:{margin:0},children:"Log Details"}),(0,g.jsx)("button",{onClick:e,style:Ps,children:"\u2715"})]}),(0,g.jsxs)("div",{style:xs,children:[(0,g.jsx)(Z,{label:"ID",value:t.id}),(0,g.jsx)(Z,{label:"Type",value:`${xo(t.type)} ${t.type}`}),(0,g.jsx)(Z,{label:"Level",value:t.level}),(0,g.jsx)(Z,{label:"Timestamp",value:new Date(t.timestamp).toISOString()}),(0,g.jsx)(Z,{label:"Signal ID",value:t.signalId}),t.signalLabel&&(0,g.jsx)(Z,{label:"Signal Label",value:t.signalLabel}),t.metadata&&(0,g.jsx)(Z,{label:"Metadata",value:JSON.stringify(t.metadata,null,2),isCode:!0}),t.oldValue!==void 0&&(0,g.jsx)(Z,{label:"Old Value",value:JSON.stringify(t.oldValue,null,2),isCode:!0}),t.newValue!==void 0&&(0,g.jsx)(Z,{label:"New Value",value:JSON.stringify(t.newValue,null,2),isCode:!0}),t.message&&(0,g.jsx)(Z,{label:"Message",value:t.message}),t.stack&&(0,g.jsx)(Z,{label:"Stack Trace",value:t.stack,isCode:!0})]})]})})}function Z({label:t,value:e,isCode:n}){return(0,g.jsxs)("div",{style:{marginBottom:"10px"},children:[(0,g.jsx)("div",{style:{fontWeight:600,marginBottom:"5px",fontSize:"12px",color:"#666"},children:t}),n?(0,g.jsx)("pre",{style:Cs,children:e}):(0,g.jsx)("div",{children:e})]})}function xo(t){switch(t){case"create":return"\u{1F7E2}";case"update":return"\u{1F535}";case"destroy":return"\u{1F534}";default:return"\u26AA"}}function ln(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="object")try{let e=JSON.stringify(t);return e.length>30?e.substring(0,27)+"...":e}catch{return"[Object]"}return String(t)}var gs={display:"flex",flexDirection:"column",height:"100%",backgroundColor:"#f5f5f5",fontFamily:"system-ui, -apple-system, sans-serif"},ps={display:"flex",justifyContent:"space-between",alignItems:"center",padding:"15px",backgroundColor:"#fff",borderBottom:"1px solid #e0e0e0"},fs={display:"flex",gap:"15px",padding:"10px 15px",backgroundColor:"#fff",borderBottom:"1px solid #e0e0e0",fontSize:"13px"},Xe={display:"flex",gap:"5px"},ms={display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",gap:"10px",padding:"10px 15px",backgroundColor:"#fff",borderBottom:"1px solid #e0e0e0"},ys={padding:"8px 12px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px"},cn={padding:"8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"14px",backgroundColor:"#fff"},hs={flex:1,overflowY:"auto",padding:"10px"},bs={display:"flex",alignItems:"center",gap:"10px",padding:"8px 12px",marginBottom:"2px",borderRadius:"4px",cursor:"pointer",transition:"background-color 0.15s",fontSize:"14px"},vs={display:"flex",alignItems:"center",justifyContent:"center",height:"200px",color:"#999",fontSize:"14px"},So={padding:"6px 12px",border:"1px solid #ddd",borderRadius:"4px",backgroundColor:"#fff",cursor:"pointer",fontSize:"14px"},Ss={position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},Ts={backgroundColor:"#fff",borderRadius:"8px",padding:"20px",maxWidth:"600px",maxHeight:"80vh",overflow:"auto",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.2)"},xs={fontSize:"14px"},Ps={padding:"4px 8px",border:"none",backgroundColor:"transparent",cursor:"pointer",fontSize:"18px",color:"#666"},Cs={backgroundColor:"#f5f5f5",padding:"10px",borderRadius:"4px",fontSize:"12px",fontFamily:"monospace",overflow:"auto",maxHeight:"200px"};
