"use strict";var T=Object.defineProperty;var te=Object.getOwnPropertyDescriptor;var re=Object.getOwnPropertyNames;var oe=Object.prototype.hasOwnProperty;var ie=(e,n)=>{for(var t in n)T(e,t,{get:n[t],enumerable:!0})},ae=(e,n,t,r)=>{if(n&&typeof n=="object"||typeof n=="function")for(let o of re(n))!oe.call(e,o)&&o!==t&&T(e,o,{get:()=>n[o],enumerable:!(r=te(n,o))||r.enumerable});return e};var se=e=>ae(T({},"__esModule",{value:!0}),e);var he={};ie(he,{batch:()=>Z,createComputed:()=>Q,createEffect:()=>v,createSignal:()=>m,flushSync:()=>K,untrack:()=>J,useSignal:()=>X,useSignalEffect:()=>ee,useSignalValue:()=>V});module.exports=se(he);var h=[],p=new Map,le=0,U=!0;function ue(){return`signal_${++le}_${Date.now()}`}function I(e,n,t){let r={id:ue(),type:e,createdAt:Date.now(),label:t};if(p.set(r.id,r),U){for(let o of h)if(o.onSignalCreate)try{o.onSignalCreate(r,n)}catch(a){console.error(`Error in plugin "${o.name}" onSignalCreate:`,a)}}return r}function B(e,n,t,r="set"){if(!U)return;let o=p.get(e);if(!o)return;let a={signal:o,oldValue:n,newValue:t,timestamp:Date.now(),source:r};for(let u of h)if(u.onSignalUpdate)try{u.onSignalUpdate(a)}catch(ne){console.error(`Error in plugin "${u.name}" onSignalUpdate:`,ne)}}function R(e){if(!U)return;let n=p.get(e);if(n){for(let t of h)if(t.onSignalDestroy)try{t.onSignalDestroy(n)}catch(r){console.error(`Error in plugin "${t.name}" onSignalDestroy:`,r)}p.delete(e)}}var s=1,x=2,_=4,w=8,A=16,F=1e4,L=new Array(F),b=0;function ce(e){b<F&&(e.value=void 0,e.subscribers=null,e.listeners=null,e.dependencies=null,e.computeFn=null,e.flags=0,L[b++]=e)}var y=new WeakMap,k=new Map;var C=1e4,H=new Array(C),c=0,d=0,P=!1;function ge(e){if(e.flags&x)return;let n=(d+1)%C;n===c&&(console.error("[SignalForge] Batch queue overflow \u2192 forcing flush"),E()),e.flags|=x,H[d]=e,d=n,P||(P=!0,queueMicrotask(E))}function E(){for(P=!1;c!==d;){let e=H[c];c=(c+1)%C,e.flags&=~x,e.flags&s&&f(e)}}var N=new Array(100),q=0,i=null;function de(e){N[q++]=i,i=e}function fe(){i=N[--q]}var pe=function(){return this._node.value},ye=function(e){this._node.subscribers||(this._node.subscribers=new Set),this._node.subscribers.add(e)},be=function(e){this._node.subscribers&&this._node.subscribers.delete(e)};function M(e,n=null){let t=b>0?L[--b]:{value:void 0,subscribers:null,listeners:null,dependencies:null,computeFn:null,flags:0};return t.value=e,t.computeFn=n,t.flags=n?A|s:0,n&&f(t),t}function G(e,n){return i?(i!==e&&(j(e,i),Se(i,n)),e.flags&s&&e.computeFn&&f(e),e.value):(e.flags&s&&e.computeFn&&f(e),e.value)}function me(e,n,t){if(e.flags&A)throw new Error("Cannot set computed signal");if(typeof t=="function"&&(t=t(e.value)),Object.is(t,e.value))return;let r=e.value;e.value=t;let o=y.get(n);o&&B(o,r,t,"set"),W(e)}function j(e,n){e.subscribers||(e.subscribers=new Set),e.subscribers.add(n)}function ve(e,n){e.subscribers&&e.subscribers.delete(n)}function Se(e,n){e.dependencies||(e.dependencies=new Set),e.dependencies.has(n)||(e.dependencies.add(n),j(n._node,e))}function O(e){if(e.dependencies){for(let n of e.dependencies)ve(n._node,e);e.dependencies.clear()}}function $(e){if(!(e.flags&s)&&(e.flags|=s,ge(e),e.subscribers))for(let n of e.subscribers)$(n)}function f(e){if(e.computeFn&&!(e.flags&_)){e.flags|=_,O(e),de(e);try{let n=e.computeFn();e.flags&=~s,e.flags&=~_,Object.is(n,e.value)||(e.value=n,W(e))}finally{fe()}}}function W(e){if(e.subscribers)for(let n of e.subscribers)$(n);if(e.flags&w&&e.listeners)for(let n of e.listeners)n(e.value)}function z(e,n){return e.listeners||(e.listeners=new Set),e.listeners.add(n),e.flags|=w,()=>{e.listeners.delete(n),e.listeners.size===0&&(e.flags&=~w)}}function D(e){O(e),e.subscribers&&e.subscribers.clear(),e.listeners&&e.listeners.clear(),ce(e)}function m(e){let n=M(e,null),t={get:()=>G(n,t),set:o=>me(n,t,o),subscribe:o=>z(n,o),destroy:()=>{let o=y.get(t);o&&(R(o),k.delete(o),y.delete(t)),D(n)},_node:n,_peek:pe,_addSubscriber:ye,_removeSubscriber:be},r=I("signal",e);return y.set(t,r.id),k.set(r.id,t),t}function Q(e){let n,t=i;i=null;try{n=e()}finally{i=t}let r=M(n,e),o={get:()=>G(r,o),set:()=>{throw new Error("Cannot set computed signal")},subscribe:a=>z(r,a),destroy:()=>D(r),_node:r,_peek:()=>r.value,_addSubscriber:a=>{r.subscribers||(r.subscribers=new Set),r.subscribers.add(a)},_removeSubscriber:a=>{r.subscribers&&r.subscribers.delete(a)},_markDirty:()=>$(r),_recompute:()=>f(r)};return o}function v(e){let n=M(void 0,e);return()=>D(n)}function Z(e){let n=e();return Y(),n}function Y(){c!==d&&E()}function J(e){let n=i;i=null;try{return e()}finally{i=n}}var K=Y;var l=require("react");function Te(){if(typeof l.useState!="function"||typeof l.useEffect!="function")throw new Error(`[SignalForge] React hooks unavailable. Possible duplicate React instance or invalid bundler resolution.
Troubleshooting:
  1. Ensure only one react copy: node_modules/react (no nested copy under library).
  2. Clear Metro cache: npx react-native start --reset-cache.
  3. Verify metro.config.js extraNodeModules maps react to example app node_modules.`)}Te();function V(e){let[n,t]=(0,l.useState)(()=>e.get());return(0,l.useEffect)(()=>(t(e.get()),e.subscribe(()=>t(e.get()))),[e]),n}function X(e){let[n]=(0,l.useState)(()=>{let r=typeof e=="function"?e():e;return m(r)});return[V(n),n.set.bind(n)]}var g=require("react");var S=new WeakMap;function ee(e,n=[]){let t=(0,g.useRef)({}),r=(0,g.useRef)(null),o=(0,g.useRef)(null);(0,g.useEffect)(()=>{let a=()=>{if(!S.get(t.current)){S.set(t.current,!0);try{r.current&&(r.current(),r.current=null);let u=e();typeof u=="function"&&(r.current=u)}finally{S.set(t.current,!1)}}};return o.current=v(a),()=>{r.current&&r.current(),o.current&&o.current(),S.delete(t.current)}},n)}
